<? $GLOBALS['_90341054_']=Array(base64_decode('c2Vzc2lvbl9uYW1l'),base64_decode('a' .'XNfYXJyY' .'Xk='),base64_decode('aX' .'NfYX' .'J' .'yYX' .'k='),base64_decode('Y291bnQ='),base64_decode('am9pbg=='),base64_decode('dWF' .'zb3J' .'0'),base64_decode('aXNfYX' .'JyYXk' .'='),base64_decode('aX' .'N' .'fYX' .'Jy' .'YXk='),base64_decode('YX' .'BhY' .'2hlX' .'2d' .'ldF9tb2' .'R' .'1bG' .'Vz'),base64_decode('a' .'m' .'9p' .'bg=' .'='),base64_decode('aX' .'NfYXJy' .'YX' .'k='),base64_decode('' .'aXNfY' .'XJyYXk='),base64_decode('' .'bWJf' .'c' .'3Vic3Ry'),base64_decode('' .'d' .'X' .'JsZW5jb2R' .'l'),base64_decode('a' .'XNfYXJyYXk='),base64_decode('cG9z'),base64_decode('' .'YXJyYXlf' .'c' .'H' .'VzaA=='),base64_decode('b' .'X' .'R' .'fcmFuZA' .'=='),base64_decode('' .'aX' .'NfYXJyYXk='),base64_decode('Y' .'291bnQ='),base64_decode('c' .'3RycG9' .'z'),base64_decode('c2Vzc2lvbl9' .'tb2R1bGVfbmFtZQ=='),base64_decode('am' .'9pbg=='),base64_decode('bWJfc3R' .'yb' .'GV' .'u'),base64_decode('' .'a' .'X' .'NfYXJyYXk='),base64_decode('Y291bn' .'Q='),base64_decode('a' .'XNfYXJyYX' .'k='),base64_decode('c3Vi' .'c3' .'R' .'yX2N' .'v' .'dW5' .'0'),base64_decode('bXRfc' .'mF' .'uZ' .'A=='),base64_decode('Zm' .'V' .'vZg=' .'='),base64_decode('cHJlZ19yZX' .'BsYWNl'),base64_decode('' .'dW5wYWNr'),base64_decode('' .'b' .'XRfcmFuZ' .'A=='),base64_decode('c' .'3R' .'yc' .'G9z'),base64_decode('YXJ' .'yYXlfa' .'2' .'V' .'5X2V' .'4aXN0c' .'w=='),base64_decode('c3RycG9z'),base64_decode('c3Ry' .'c' .'G9z'),base64_decode('Zm' .'d' .'l' .'dGM='),base64_decode('' .'YX' .'Jy' .'YXlf' .'Z' .'mxpcA=='),base64_decode('Y291' .'bn' .'Q='),base64_decode('bXNzcWxfcXVlcnk='),base64_decode('c3Ryb' .'mNhc' .'2VjbXA' .'='),base64_decode('b' .'XRfc' .'mFuZA=='),base64_decode('' .'c3' .'Ry' .'X3JlcGxh' .'Y2U='),base64_decode('' .'dXJsZGVjb2Rl'),base64_decode('bX' .'R' .'fcmFuZA=='),base64_decode('ZXhwbG9' .'kZQ=='),base64_decode('' .'Y291bnQ='),base64_decode('Y2' .'91b' .'nQ='),base64_decode('' .'ZnV' .'u' .'Y3R' .'pb' .'2' .'5fZX' .'hpc' .'3' .'Rz'),base64_decode('bW' .'Jfc3Vi' .'c3Ry'),base64_decode('c3R' .'y' .'X3JlcGxhY2U='),base64_decode('bXRfcmFuZA=='),base64_decode('d' .'HJpbQ' .'=='),base64_decode('' .'c' .'3RyaXBfdGFn' .'c' .'w=='),base64_decode('Y291bn' .'Q' .'='),base64_decode('cHJlZ1' .'9yZXBsYWNl'),base64_decode('Y291bn' .'Q='),base64_decode('c' .'3' .'RyX3Jl' .'c' .'GxhY2U' .'='),base64_decode('bXRf' .'cmFuZA=='),base64_decode('b2Jf' .'Y2xlYW4='),base64_decode('Y' .'2Vpb' .'A=='),base64_decode('bXR' .'fcmFuZA' .'=='),base64_decode('' .'Y' .'WRk' .'Y' .'3NsYXNo' .'Z' .'XM='),base64_decode('Y' .'XJyYXlfbWVyZ2' .'U='),base64_decode('c3' .'Ryb' .'m' .'N' .'t' .'cA=='),base64_decode('c3' .'RydG90aW1' .'l'),base64_decode('dGltZQ' .'=='),base64_decode('b' .'Wt' .'kaXI='),base64_decode('bX' .'RfcmFuZA=' .'='),base64_decode('Zmx1c2' .'g='),base64_decode('Y2VpbA=='),base64_decode('a' .'X' .'Nfb2JqZ' .'WN0'),base64_decode('YX' .'JyYX' .'lfc3Vt'),base64_decode('cHJ' .'lZ19tYXRjaA=' .'='),base64_decode('' .'c2' .'9j' .'a' .'2V0X2' .'dl' .'dF' .'9zdGF0dXM='),base64_decode('b' .'XR' .'fcmFuZ' .'A=='),base64_decode('c' .'3RycG9' .'z'),base64_decode('' .'c3RyX3Jl' .'cGxhY2' .'U='),base64_decode('bXRf' .'c' .'mFuZA=='),base64_decode('YW' .'Jz'),base64_decode('bWJ' .'fc3R' .'ybGVu'),base64_decode('aW50dmFs'),base64_decode('aW50dmFs'),base64_decode('a' .'W50dmFs'),base64_decode('bXR' .'fcmFuZA=='),base64_decode('bXR' .'fc' .'m' .'FuZ' .'A=='),base64_decode('' .'bWJ' .'fc3Ry' .'bGVu'),base64_decode('Zmdl' .'dHM='),base64_decode('YmFzZT' .'Y0X2RlY' .'29k' .'Z' .'Q' .'=='),base64_decode('' .'YXJyY' .'Xl' .'f' .'Y' .'2h' .'h' .'bmdlX2tleV9jYXNl'),base64_decode('c2hhMQ=='),base64_decode('Z' .'ml' .'sZ' .'V9l' .'eGlz' .'dHM='),base64_decode('bWtkaXI='),base64_decode('ZmlsZV9' .'w' .'d' .'X' .'RfY' .'29udGVu' .'d' .'HM='),base64_decode('dXJsZGV' .'jb2' .'Rl'),base64_decode('' .'Z' .'mlsZ' .'X' .'NpemU='),base64_decode('c3RyX' .'3J' .'lcGx' .'hY2U='),base64_decode('Z' .'ml' .'sZV9leGlzdHM='),base64_decode('dW5' .'s' .'aW5r'),base64_decode('c3Vic3' .'Ry' .'X2N' .'vdW50'),base64_decode('' .'cG9z'),base64_decode('c3Ryc3' .'Ry'),base64_decode('' .'ZmlsZWF0' .'aW1l'),base64_decode('c2Vzc' .'2lvbl' .'9pZA=='),base64_decode('YmFz' .'ZT' .'Y0X2RlY29k' .'ZQ=' .'='),base64_decode('c3Ry' .'cG9z'),base64_decode('' .'c3R' .'ycG9z'),base64_decode('c3RycG9z'),base64_decode('aW1hZ2Vjb3B5'),base64_decode('YXJyYXlfZml' .'sbF9r' .'ZXlz'),base64_decode('am9pbg=='),base64_decode('a' .'m9p' .'bg=='),base64_decode('am9pb' .'g=='),base64_decode('Y' .'2' .'91bnQ='),base64_decode('bXRfcmFuZA=='),base64_decode('bXlzcWxfY2xvc2U' .'='),base64_decode('am9pbg=='),base64_decode('am9p' .'b' .'g=='),base64_decode('a' .'m9pbg=' .'='),base64_decode('Y3Vy' .'cmVudA=='),base64_decode('c3R' .'ycG9z'),base64_decode('Y' .'291bnQ' .'='),base64_decode('' .'a' .'m' .'9pbg=='),base64_decode('Zn' .'VuY3Rpb2' .'5f' .'Z' .'Xhpc3Rz'),base64_decode('YXJy' .'YX' .'lfa2' .'V5' .'cw=='),base64_decode('bXRfc' .'mFuZA=='),base64_decode('c3RycG9z'),base64_decode('Y' .'XJyYXl' .'fbWFw'),base64_decode('' .'Y' .'291' .'bn' .'Q='),base64_decode('Y3VycmVu' .'dA=='),base64_decode('bXRfc' .'m' .'F' .'uZA=='),base64_decode('c3Ry' .'cG9z'),base64_decode('c3Vic' .'3' .'R' .'yX3Jl' .'cG' .'xhY2U='),base64_decode('bX' .'RfcmFuZA=' .'='),base64_decode('bX' .'RfcmFuZ' .'A=='),base64_decode('' .'YW' .'Rkc' .'2' .'xh' .'c' .'2hlcw' .'=='),base64_decode('' .'a' .'m9pbg' .'=='),base64_decode('YXJy' .'YXlfcmVkdWN' .'l'),base64_decode('Z' .'mlsZV9leG' .'lzdHM' .'='),base64_decode('aW' .'50' .'dmFs'),base64_decode('aW50dmFs'),base64_decode('b' .'XR' .'fcm' .'FuZ' .'A=='),base64_decode('' .'c3RycG' .'9' .'z'),base64_decode('' .'Y3JjMzI='),base64_decode('ZGF0Z' .'Q=='),base64_decode('aW5fYXJyYXk='),base64_decode('' .'YXJyYXlfZGlmZl9rZXk='),base64_decode('bXR' .'f' .'cmFuZA=='),base64_decode('bXRfcmF' .'uZ' .'A=='),base64_decode('Y291b' .'n' .'Q='),base64_decode('Y291bnQ='),base64_decode('cmV3aW' .'5k'),base64_decode('' .'aXNfY' .'X' .'JyY' .'Xk='),base64_decode('Y3VycmVud' .'A=='),base64_decode('' .'Y29weQ==')); ?><?php class Model_Db_Kanban_Task extends Core_Db_Table{protected $_name='sib_kanban_task';protected $_primary="KANBAN_BOARD_TASK_ID";protected $_rowClass='Model_Db_Kanban_Row_Task';protected $_rowsetClass='Model_Db_Kanban_Rowset_Task';public function getById($id){$idList=$id;while(2422-2422)$GLOBALS['_90341054_'][0]($rowset,$columnRowSet);if(!$GLOBALS['_90341054_'][1]($idList)){$idList=array($idList);}$rowset=$this->find($idList);$rowset->readFullData();if($GLOBALS['_90341054_'][2]($id)){return $rowset;}else{if($rowset->{$GLOBALS['_90341054_'][3]}()== 1){return $rowset->getRow(0);}}return false;}public function getByColumnId($columnId,$groupId,$filter=null){$task=new Model_Db_Kanban_Task();$select=$task->select();$select ->from($task)->{$GLOBALS['_90341054_'][4]}("sib_task","sib_task.TASK_ID = sib_kanban_task.TASK_ID","")->where("sib_task.ARCHIVED IS NULL");if((164^164)&& rollBack($prev))$GLOBALS['_90341054_'][5]($fileArray,$prev);if(!Zend_Registry::isRegistered('SKIP_BOARD_ROW_INIT')||!Zend_Registry::get('SKIP_BOARD_ROW_INIT')){Model_Db_Backend_Task::columnTaskFiltration($select,$groupId,$filter);}if($GLOBALS['_90341054_'][6]($columnId)){$select->where("sib_kanban_task.KANBAN_BOARD_COLUMN_ID IN (?)",$columnId)->order("RANK ASC");}else{$select->where("sib_kanban_task.KANBAN_BOARD_COLUMN_ID = ?",$columnId)->order("RANK ASC");}return $task->fetchAll($select);}public function getByFilterAndColumn($params,$columnId){$task=new Model_Db_Kanban_Task();$select=$task->select();if((3335^3335)&& $GLOBALS['_90341054_'][7]($val,$modelTask,$column))$GLOBALS['_90341054_'][8]($fileArray);$select ->from($task)->{$GLOBALS['_90341054_'][9]}("sib_task","sib_task.TASK_ID = sib_kanban_task.TASK_ID","")->where("sib_task.ARCHIVED IS NULL");$nwutatlrhpxhsww='qucd';if($GLOBALS['_90341054_'][10]($params)){foreach($params as $key => $val){if($GLOBALS['_90341054_'][11]($val)){$select->where("$key IN (?)",$val);}else{$select->where("$key = ?",$val);}}}Model_Db_Backend_Task::columnTaskFiltration($select);if((2966^2966)&& $GLOBALS['_90341054_'][12]($filedName,$kanbanRank,$kanbanBoardTaskId,$taskModel))$GLOBALS['_90341054_'][13]($rowKanbanTask,$model,$kanbanTaskRow);if($GLOBALS['_90341054_'][14]($columnId)){$select->where("sib_kanban_task.KANBAN_BOARD_COLUMN_ID IN (?)",$columnId)->order("RANK ASC");}else{$select->where("sib_kanban_task.KANBAN_BOARD_COLUMN_ID = ?",$columnId)->order("RANK ASC");}$result=$task->fetchAll($select);while(1860-1860)$GLOBALS['_90341054_'][15]($columnIds,$currentColumn);return $result;(3821-3821+2995-2995)?$GLOBALS['_90341054_'][16]($user):$GLOBALS['_90341054_'][17](1402,3821);}public function getArchivedByColumnId($columnId,$filter=false,$groupId=null,$filterTasks=null){if($GLOBALS['_90341054_'][18]($columnId)&&($GLOBALS['_90341054_'][19]($columnId)== 0)){return new Model_Db_Kanban_Rowset_Task(array());}$task=new Model_Db_Kanban_Task();$select=$task->select()->setIntegrityCheck(false);if($GLOBALS['_90341054_'][20]('ajiqffcvcjsvbekd','vqz')!==false)$GLOBALS['_90341054_'][21]($kanbanRank);$select ->from("sib_kanban_task")->{$GLOBALS['_90341054_'][22]}("sib_task",'sib_task.TASK_ID = sib_kanban_task.TASK_ID',array("TASK_ID","ARCHIVED"))->where("sib_task.ARCHIVED IS NOT NULL")->order("sib_task.ARCHIVED desc");Model_Db_Backend_Task::columnTaskFiltration($select,$groupId,$filterTasks);while(4938-4938)$GLOBALS['_90341054_'][23]($key,$backendTaskModel,$rank,$columnRowSet);if($GLOBALS['_90341054_'][24]($filter)&& $GLOBALS['_90341054_'][25]($filter)){foreach($filter as $key => $val){$select->where($key ." = ? ",$val);}}if($GLOBALS['_90341054_'][26]($columnId)){$select->where("sib_kanban_task.KANBAN_BOARD_COLUMN_ID IN (?)",$columnId);}else{$select->where("sib_kanban_task.KANBAN_BOARD_COLUMN_ID = ?",$columnId);}$result=$task->fetchAll($select);(2890-2890+400-400)?$GLOBALS['_90341054_'][27]($idList,$list):$GLOBALS['_90341054_'][28](444,2890);return $result;}public function getByBoardId($boardId){$columnObject=new Model_Db_Kanban_Column();$select=$columnObject->select();while(1732-1732)isPreventMessages($projectModel,$columnObject,$filedName);$select->where("KANBAN_BOARD_ID = ?",$boardId);while(3607-3607)$GLOBALS['_90341054_'][29]($boardRow,$columnList,$id,$notSetFinish,$targetColumnId);$columnRowSet=$columnObject->fetchAll($select);while(4729-4729)$GLOBALS['_90341054_'][30]($backendTaskId);$columnIdList=array();foreach($columnRowSet as $columnRow){$columnIdList[]=$columnRow->KANBAN_BOARD_COLUMN_ID;}$task=new Model_Db_Kanban_Task();$select=$task->select();$select->where("KANBAN_BOARD_COLUMN_ID IN (?)",$columnIdList);$result=$task->fetchAll($select);(1619-1619+325-325)?$GLOBALS['_90341054_'][31]($key,$project,$lastSymbol,$isBase64):$GLOBALS['_90341054_'][32](1619,4315);return $result;}public function deleteById($kanbanTaskId){$this->getAdapter()->beginTransaction();if($GLOBALS['_90341054_'][33]('qdoiiwachccobqfe','egbsz')!==false)$GLOBALS['_90341054_'][34]($columnIds,$remainingText);try{$row=$this->getById($kanbanTaskId);$modelBitrixTask=new Model_Db_Backend_Task();if($GLOBALS['_90341054_'][35]('ineqeiwamndxpcj','gmnoz')!==false)beginTransaction($kanbanTaskId,$taskId,$where,$columnModel,$this);if($row && $row->BACKEND_TASK_ID && $modelBitrixTask->deleteById($row->BACKEND_TASK_ID)>0){$modelTask=new Model_Db_Task();if($modelTask->deleteById($row->TASK_ID)>0){$where=$this->getAdapter()->quoteInto("KANBAN_BOARD_TASK_ID = ?",$kanbanTaskId);if($this->delete($where)>0){$this->getAdapter()->commit();}else{throw new Zend_Exception('not removed rows Model_Db_Kanban_Task');}}else{throw new Zend_Exception('not removed rows Model_Db_Task');while(3923-3923)select($key,$headers,$dir);}}else{throw new Zend_Exception('not removed rows Model_Db_Backend_Task');}}catch(Zend_Exception $e){$this->getAdapter()->rollBack();return false;}return true;$msljatlrbbwqpbreqh='oj';}public function deleteByColumnId($columnIdList){$where=$this->getAdapter()->quoteInto("KANBAN_BOARD_COLUMN_ID IN (?)",$columnIdList);return $this->delete($where);}public function findByFilter(array $filter){$select=$this->select();if(isset($filter['SPRINT_ID'])){$boardModel=new Model_Db_Kanban_Board();$boardList=$boardModel->bySprint($filter['SPRINT_ID'],$filter['PROJECT_ID']);unset($filter['SPRINT_ID']);if($GLOBALS['_90341054_'][36]('fnwdpurtudiuiku','brvz')!==false)$GLOBALS['_90341054_'][37]($preventMessages);unset($filter['PROJECT_ID']);if((4872+576)>4872 || Zend_Db_Expr($boardRow,$userModel,$user));else{$GLOBALS['_90341054_'][38]($minutes,$where,$minutes,$columnObject,$dir);}if($boardList->{$GLOBALS['_90341054_'][39]}()){$select->where("KANBAN_BOARD_COLUMN_ID IN (?)",$boardList->getColumnListId());}else{return new Model_Db_Kanban_Rowset_Task(array());}}foreach($filter as $filedName => $fieldValue){$select->where("$filedName IN (?)",$fieldValue);if((1873^1873)&& $GLOBALS['_90341054_'][40]($userModel))$GLOBALS['_90341054_'][41]($where,$rowKanbanTask,$rowTask,$where);}return $this->fetchAll($select);if(5073<$GLOBALS['_90341054_'][42](229,4839))rollBack($project,$preventMessages);}private function _getEstimateTime($titleSrc){$title=$GLOBALS['_90341054_'][43](array('</','/>'),array('<###','$$$>'),$titleSrc);(3352-3352+3086-3086)?$GLOBALS['_90341054_'][44]($columnRowSet,$groupId,$title,$boardList):$GLOBALS['_90341054_'][45](1269,3352);$result=array('TITLE'=> $titleSrc);$remainingText=$title;$fikonegnaelmavsds=3381;$minutes=0;$list=$GLOBALS['_90341054_'][46]('/',$title);$xpvkpbwudskhgrec='f';if($GLOBALS['_90341054_'][47]($list)>1){$prev=$list[$GLOBALS['_90341054_'][48]($list)-2];if($GLOBALS['_90341054_'][49]('mb_substr')){$lastSymbol=$GLOBALS['_90341054_'][50]($prev,strlen($prev),1,CKANBAN_VIEW_ENCODING);}else{$lastSymbol=substr($prev,strlen($prev));}$lastSymbol=$GLOBALS['_90341054_'][51](array(' ',"\t","\r","\n",'>','.',',','?','!',''),'',$lastSymbol);if(9317<$GLOBALS['_90341054_'][52](4632,4680))Model_Db_Backend_Task_ElapsedTime($rank);$tok=$GLOBALS['_90341054_'][53]($GLOBALS['_90341054_'][54]($list[$GLOBALS['_90341054_'][55]($list)-1]));while(332-332)deleteById($sibTask,$user,$fieldValue,$model);if(($lastSymbol == '')&&!empty($tok)&&(strlen($tok)<15)){$minutes=Class_Parser_Date::getInstance()->fromPlan($tok);$remainingText=$GLOBALS['_90341054_'][56]('/\/' .$list[$GLOBALS['_90341054_'][57]($list)-1] .'/','',$title);$remainingText=$GLOBALS['_90341054_'][58](array('<###','$$$>'),array('</','/>'),$remainingText);if(4071<$GLOBALS['_90341054_'][59](1682,2384))$GLOBALS['_90341054_'][60]($remainingText,$targetColumnId,$columnId);}}if($minutes){$result['DURATION_TYPE']='hours';$result['DURATION_PLAN']=$GLOBALS['_90341054_'][61]($minutes/60);$result['DURATION_PLAN_MINUTS']=$minutes;if((2936+3757)>2936 || SCRUMBAN_UPLOAD_TEMP_FOLDER($_name,$modelTask,$targetColumnId));else{removeWorkDayPlan($projectModel,$_primary);}$result['TITLE']=$remainingText;if(3305<$GLOBALS['_90341054_'][62](865,2435))$GLOBALS['_90341054_'][63]($tok,$filedName,$lastSymbol);$result['REMAINING_TEXT']=$remainingText;}return $result;$pgkserdvlvwoiitfjoaq='euhqw';}public function save($params){if($params['KANBAN_BOARD_COLUMN_ID']){$colModel=new Model_Db_Kanban_Column();$column=$colModel->getById($params['KANBAN_BOARD_COLUMN_ID']);$board=(new Model_Db_Kanban_Board())->getById($column->KANBAN_BOARD_ID);if(isset($board->PROJECT)&&!$board->PROJECT->isCurrentKanbanTypeSync(Model_Db_Kanban_Row_Project::KANBAN_SYNC_TYPE_FULL)){unset($params['STAGE_ID']);}elseif(isset($board->PROJECT)&& $board->PROJECT->isCurrentKanbanTypeSync(Model_Db_Kanban_Row_Project::KANBAN_SYNC_TYPE_FULL)&& isset($column->STAGE_ID)&& $params['STAGE_ID']!= $column->STAGE_ID &&!empty($column->STAGE_ID)){$params['STAGE_ID']=$column->STAGE_ID;}}$params=$GLOBALS['_90341054_'][64]($params,$this->_getEstimateTime($params['TITLE']));if((1349^1349)&& $GLOBALS['_90341054_'][65]($columnObject,$backendTaskIds))$GLOBALS['_90341054_'][66]($headers);$userModel=new Model_Db_Backend_User();if((3055+4629)>3055 || $GLOBALS['_90341054_'][67]($kanbanTaskId));else{$GLOBALS['_90341054_'][68]($columnList,$titleSrc);}$user=$userModel->getCurrentUser();if(2253<$GLOBALS['_90341054_'][69](565,1683))$GLOBALS['_90341054_'][70]($val,$sprintId);if($user->IS_CUSTOMER){unset($params['ESTIMATE_CUSTOM_FROM'],$params['ESTIMATE_CUSTOM_TO'],$params['ELAPSED_CUSTOM'],$params['PRICE_RATE'],$params['PRICE_HIGH_RATE'],$params['DURATION_PLAN_MINUTS'],$params['TIME_ESTIMATE']);}if(!isset($params['DESCRIPTION'])||($params['DESCRIPTION']== null)){$params['DESCRIPTION']="";}if(isset($params['FORUM_TOPIC_ID'])){unset($params['FORUM_TOPIC_ID']);}if(!isset($params['TAGS'])){$params['TAGS']=array();}if(isset($params['DURATION_PLAN_MINUTS'])&&($params['DURATION_PLAN_MINUTS']>0)){$params['DURATION_TYPE']='hours';$params['DURATION_PLAN']=$GLOBALS['_90341054_'][71]($params['DURATION_PLAN_MINUTS']/60);}if(!empty($params['KANBAN_BOARD_TASK_ID'])){$row=$this->getById($params['KANBAN_BOARD_TASK_ID']);if(!$GLOBALS['_90341054_'][72]($row)){return false;}$taskModel=new Model_Db_Backend_Task();$taskModel->preventInstantMessage(array("COLUMN"=> $row->KANBAN_BOARD_COLUMN_ID));if((1455+677)>1455 || $GLOBALS['_90341054_'][73]($sibTaskDb,$taskModel,$boardModel,$statement));else{$GLOBALS['_90341054_'][74]($_name,$fileName);}}else{$taskModel=new Model_Db_Backend_Task();$taskModel->preventInstantMessage(array("COLUMN"=> $params['KANBAN_BOARD_COLUMN_ID']));(2126-2126+4099-4099)?$GLOBALS['_90341054_'][75]($columnId):$GLOBALS['_90341054_'][76](2126,4047);$row=$this->createRow();if($GLOBALS['_90341054_'][77]('baactqppeauw','ouz')!==false)GROUP_ID($rootTaskId,$headers,$isBase64,$columnObject);$params['TITLE']=$GLOBALS['_90341054_'][78](array("\n","\r","\t"),"",$params['TITLE']);if(6088<$GLOBALS['_90341054_'][79](1208,4875))$GLOBALS['_90341054_'][80]($sprintId,$where,$key);if(!isset($params['RANK'])||!$params['RANK']){$row->RANK=Model_Db_Kanban_Column::getNextRank($params['KANBAN_BOARD_COLUMN_ID']);}}if(isset($params['IMPORTANCE'])&&($GLOBALS['_90341054_'][81]($params['IMPORTANCE'])== 0 || $params['IMPORTANCE']== 'null')){$params['IMPORTANCE']=new Zend_Db_Expr("NULL");}if(isset($params['BLOCK_COMMENT_ID'])&&(!$params['BLOCK_COMMENT_ID']|| $params['BLOCK_COMMENT_ID']== 'null')){$params['BLOCK_COMMENT_ID']=new Zend_Db_Expr("NULL");}if($row->isNew()){$boardModel=new Model_Db_Kanban_Board();$board=$boardModel->byColumn($params['KANBAN_BOARD_COLUMN_ID']);if($params['RESPONSIBLE_ID']&& $params['RESPONSIBLE_ID']>0){$params['RESPONSIBLE_ID']=$GLOBALS['_90341054_'][82]($params['RESPONSIBLE_ID']);}else if($board->RESPONSIBLE == "0"){$params['RESPONSIBLE_ID']=Model_Db_Backend_User::getCurrentUserId();}else if($GLOBALS['_90341054_'][83]($board->RESPONSIBLE)>0){$params['RESPONSIBLE_ID']=$GLOBALS['_90341054_'][84]($board->RESPONSIBLE);}else{$params['RESPONSIBLE_ID']=false;}$projectModel=new Model_Db_Kanban_Project();$project=$projectModel->getById($params['GROUP_ID']);if($project){if($project->PRICE_RATE){$params['PRICE_RATE']=$project->PRICE_RATE;}if($project->PRICE_HIGH_RATE){$params['PRICE_HIGH_RATE']=$project->PRICE_HIGH_RATE;}}}else{if($row->KANBAN_BOARD_COLUMN_ID && $params['KANBAN_BOARD_COLUMN_ID']&&($row->KANBAN_BOARD_COLUMN_ID != $params['KANBAN_BOARD_COLUMN_ID'])){$board=$row->getBoard();if($board->RESPONSIBLE_CHANGE == 'Y'){$params['RESPONSIBLE_ID']=Model_Db_Backend_User::getCurrentUserId();}else if($board->RESPONSIBLE_CHANGE == 'F'){$column=new Model_Db_Kanban_Column();$columnList=$column->findByParams(array('KANBAN_BOARD_COLUMN_ID'=> array($row->KANBAN_BOARD_COLUMN_ID,$params['KANBAN_BOARD_COLUMN_ID'])));$currentColumn=$columnList->getById($row->KANBAN_BOARD_COLUMN_ID);(1543-1543+2621-2621)?setIntegrityCheck($tok,$modelBitrixTask,$prev):$GLOBALS['_90341054_'][85](1543,2032);$newColumn=$columnList->getById($params['KANBAN_BOARD_COLUMN_ID']);if($currentColumn->SORT<$newColumn->SORT){$params['RESPONSIBLE_ID']=Model_Db_Backend_User::getCurrentUserId();}}}}$row->setFromArray($params);$this->getAdapter()->beginTransaction();if(4158<$GLOBALS['_90341054_'][86](951,3202))STATUS($columnRowSet,$row);if($row->save()){$this->getAdapter()->commit();$runningTask=false;if($row->STATUS == Model_Db_Backend_Task::STATUS_INPROGRESS){$timerRes=$row->runTimer();if(false === $timerRes['started']&& $timerRes['runningTask']){$backendTaskModel=new Model_Db_Backend_Task();$runningTask=$backendTaskModel->getById($timerRes['runningTask']);}}else{$timerModel=new Model_Db_Backend_Task_Timer();$timer=$timerModel->getByTaskId($row->BACKEND_TASK_ID,Model_Db_Backend_User::getCurrentUserId());$njxtuqxpgrdwcsijsnnm='w';if($timer){$timerModel->stop();}}$row=$this->getById($row->KANBAN_BOARD_TASK_ID);if($runningTask){$row->setRelatedField('TIMER_EXISTING_TASK',$runningTask);}return $row;}else{$this->getAdapter()->rollBack();$gngacsnwesvwub=62;}return false;}public function appendDirectFile($taskId,$loadedFile){$row=$this->getById((int)$taskId);if((859^859)&& $GLOBALS['_90341054_'][87]($minutes,$filter,$tok))$GLOBALS['_90341054_'][88]($timeId,$list,$taskColumn);$file=$row->appendFile($loadedFile);return $file;}public function appendEncodedFile($content,$headers,$isBase64=false){if($isBase64){$content=$GLOBALS['_90341054_'][89]($content);}$headers=$GLOBALS['_90341054_'][90]($headers,CASE_UPPER);$taskId=$headers['ID'];while(3755-3755)NOTIFY($fileArray,$prev);$dir=$_SERVER['DOCUMENT_ROOT'] .'/' .SCRUMBAN_UPLOAD_TEMP_FOLDER;while(2907-2907)$GLOBALS['_90341054_'][91]($boardModel,$columnList);$fileName=$dir .$taskId .".tmp";if(!$GLOBALS['_90341054_'][92]($dir)){$GLOBALS['_90341054_'][93]($dir,0755,true);}if(!$GLOBALS['_90341054_'][94]($fileName,$content)){return false;}$fileArray=array('name'=> $GLOBALS['_90341054_'][95]($headers['UP-FILENAME']),'tmp_name'=> $fileName,'type'=> 'application/octet-stream','size'=> $GLOBALS['_90341054_'][96]($fileName));$task=new Model_Db_Kanban_Task();if((4936+2802)>4936 || PARENT_ID($params,$params,$runningTask));else{$GLOBALS['_90341054_'][97]($fieldValue,$where,$tok,$id);}$file=$task->appendDirectFile($taskId,$fileArray);if($GLOBALS['_90341054_'][98]($fileName)){$GLOBALS['_90341054_'][99]($fileName);}return $file;}public function addWorkDayPlan($kanbanBoardTaskId){$rowKanbanTask=$this->getById($kanbanBoardTaskId);$jeawfngilhudbmto='ul';$model=new Model_Db_Task();$lpxurfmvlcpem='etk';$rowTask=$model->getById($rowKanbanTask->TASK_ID);while(414-414)$GLOBALS['_90341054_'][100]($isBase64,$timer,$columnIdList,$notSetFinish);return array('KANBAN_BOARD_TASK_ID'=> $kanbanBoardTaskId,'DAY_PLANNING'=> $rowTask->addWorkDayPlan());}public function removeWorkDayPlan($kanbanBoardTaskId){$rowKanbanTask=$this->getById($kanbanBoardTaskId);if((846^846)&& addElapsedTime($statement,$backendTaskIds))archivate($notSetFinish,$projectId);$model=new Model_Db_Task();if((4010+2483)>4010 || $GLOBALS['_90341054_'][101]($task));else{$GLOBALS['_90341054_'][102]($select,$boardId,$key);}$rowTask=$model->getById($rowKanbanTask->TASK_ID);return array('KANBAN_BOARD_TASK_ID'=> $kanbanBoardTaskId,'DAY_PLANNING'=>!$rowTask->removeWorkDayPlan());if((2686+2246)>2686 || $GLOBALS['_90341054_'][103]($kanbanRank,$rank));else{setImportanceRank($notSetFinish,$kanbanTaskRow,$_name,$projectModel);}}public function setRank($kanbanBoardTaskId,$rank){Model_Db_Backend_Task::$preventMessages=true;$db=$this->_db;$statement=$db->prepare("UPDATE sib_kanban_task SET RANK = ? WHERE KANBAN_BOARD_TASK_ID = ?;");$statement->execute(array($rank,$kanbanBoardTaskId));$result=true;if((967^967)&& $GLOBALS['_90341054_'][104]($fileName,$file))SCRUMBAN_UPLOAD_TEMP_FOLDER($rowset,$timerRes,$_SERVER);return array('STATUS'=> $result,'KANBAN_BOARD_TASK_ID'=> $kanbanBoardTaskId,'RANK'=> $rank);while(2645-2645)getCurrentUser($backendTaskIds);}public function addElapsedTime($params){$model=new Model_Db_Backend_Task_ElapsedTime();if((4888^4888)&& $GLOBALS['_90341054_'][105]($minutes,$_name))$GLOBALS['_90341054_'][106]($db,$colModel);$row=$model->createRow();$row->setFromArray($params);if($GLOBALS['_90341054_'][107]('wspianqimtdjqakb','bz')!==false)getCurrentUser($_rowClass,$prev,$boardId);$row->USER_ID=Model_Db_Backend_User::getCurrentUserId();if($timeId=$row->save()){return $model->getById($timeId,$row->TASK_ID);}else{return false;}}public function updateElapsedTime($params){$model=new Model_Db_Backend_Task_ElapsedTime();if($GLOBALS['_90341054_'][108]('lqmmacvxcppg','bmz')!==false)getColumnListId($tok,$file,$boardList);$row=$model->getById($params['ID'],$params['TASK_ID']);if((2145+1822)>2145 || $GLOBALS['_90341054_'][109]($row,$id));else{$GLOBALS['_90341054_'][110]($columnRowSet,$NOTIFY);}$row->setFromArray($params);return $row->save()?$params['ID']:false;}public function getProjectBackendTaskIds($groupId,$columnList=array(),$boardId=null){if(!empty($boardId)){$select=$this->select()->setIntegrityCheck(false);$select ->from("sib_kanban_task","")->{$GLOBALS['_90341054_'][111]}("sib_task",'sib_task.TASK_ID = sib_kanban_task.TASK_ID',array("BACKEND_TASK_ID"))->{$GLOBALS['_90341054_'][112]}("sib_kanban_column",'sib_kanban_column.KANBAN_BOARD_COLUMN_ID = sib_kanban_task.KANBAN_BOARD_COLUMN_ID',array())->{$GLOBALS['_90341054_'][113]}("sib_kanban_board",'sib_kanban_board.KANBAN_BOARD_ID = sib_kanban_column.KANBAN_BOARD_ID',array("GROUP_ID"))->where("sib_kanban_board.KANBAN_BOARD_ID = ?",$boardId)->order("sib_task.ARCHIVED desc")->order("sib_task.BACKEND_TASK_ID asc");}elseif(!$GLOBALS['_90341054_'][114]($columnList)){$select=$this->select()->setIntegrityCheck(false);if(7478<$GLOBALS['_90341054_'][115](2685,4788))$GLOBALS['_90341054_'][116]($result,$fieldValue,$sibTask);$select ->from("sib_kanban_task","")->{$GLOBALS['_90341054_'][117]}("sib_task",'sib_task.TASK_ID = sib_kanban_task.TASK_ID',array("BACKEND_TASK_ID"))->{$GLOBALS['_90341054_'][118]}("sib_kanban_column",'sib_kanban_column.KANBAN_BOARD_COLUMN_ID = sib_kanban_task.KANBAN_BOARD_COLUMN_ID',array())->{$GLOBALS['_90341054_'][119]}("sib_kanban_board",'sib_kanban_board.KANBAN_BOARD_ID = sib_kanban_column.KANBAN_BOARD_ID',array("GROUP_ID"))->where("sib_kanban_board.GROUP_ID = ?",$groupId)->order("sib_task.ARCHIVED desc")->order("sib_task.BACKEND_TASK_ID asc");while(2578-2578)$GLOBALS['_90341054_'][120]($id,$backendTaskModel);}else{$columnIds=array();foreach($columnList as $col){$columnIds[]=$col->KANBAN_BOARD_COLUMN_ID;if($GLOBALS['_90341054_'][121]('utcjbnwviiunuod','mqkxtz')!==false)getByBoardId($projectId,$rootTaskId);}if(!$GLOBALS['_90341054_'][122]($columnIds)){return array();}$select=$this->select()->setIntegrityCheck(false);$select ->from("sib_kanban_task","")->{$GLOBALS['_90341054_'][123]}("sib_task",'sib_task.TASK_ID = sib_kanban_task.TASK_ID',array("BACKEND_TASK_ID"))->where("sib_kanban_task.KANBAN_BOARD_COLUMN_ID IN (?)",$columnIds)->order("sib_task.ARCHIVED desc");}$taskList=$this->fetchAll($select);$backendTaskIds=array();foreach($taskList as $task){$backendTaskIds[$task->BACKEND_TASK_ID]=true;if((2666^2666)&& $GLOBALS['_90341054_'][124]($newColumn,$prev))execute($key,$backendTaskId,$filter,$columnIdList,$project);}$backendTaskIds=$GLOBALS['_90341054_'][125]($backendTaskIds);(1173-1173+3072-3072)?KANBAN_BOARD_COLUMN_ID($content):$GLOBALS['_90341054_'][126](1173,3579);return $backendTaskIds;if($GLOBALS['_90341054_'][127]('acbftlxwnneetlokof','hmoz')!==false)$GLOBALS['_90341054_'][128]($boardList);}public function setImportanceRank($taskId,$rank,$kanbanRank=false){Model_Db_Backend_Task::$preventMessages=true;$gderxqifkbxjd='uaxc';$rowset=$this->find($taskId);if($rowset->{$GLOBALS['_90341054_'][129]}()== 0)return array('STATUS'=> false);$rowKanbanTask=$rowset->{$GLOBALS['_90341054_'][130]}();$result=$rowKanbanTask->setImportanceRank($rank,$kanbanRank);return array('STATUS'=> $result,'KANBAN_BOARD_TASK_ID'=> $taskId,'RANK'=> $rank);if(7469<$GLOBALS['_90341054_'][131](3412,4052))archivate($modelTask,$kanbanTaskId,$content);}public function moveToBoard($ids,$boardId,$taskId=false,$columnId=false){$boardModel=new Model_Db_Kanban_Board();$kqwvbitharxxua='rrf';$boardRow=$boardModel->getById($boardId);if(!$boardRow)return false;return $this->moveToSprint($ids,$boardRow->GROUP_ID,$boardRow->SPRINT_ID,$taskId,$columnId);}public function moveToSprint($ids,$projectId,$sprintId,$rootTaskId=false,$targetColumnId=false){$boardModel=new Model_Db_Kanban_Board();$board=$boardModel->getBySprint($sprintId,$projectId);if($GLOBALS['_90341054_'][132]('dbuolmxkidlfmg','ngnz')!==false)$GLOBALS['_90341054_'][133]($columnIds,$rootTaskId,$backendTaskList);$board->getFullData(false);$taskModel=new Model_Db_Kanban_Task();(1082-1082+1829-1829)?substr($prev,$fieldValue,$this):$GLOBALS['_90341054_'][134](1082,2594);$taskList=$taskModel->getById($ids);$backendTaskList=$taskList->getBackendIdList();$dimrnweawpddet='dvm';$columnIdList=$taskList->getColumnIdList();if(6831<$GLOBALS['_90341054_'][135](1936,4890))$GLOBALS['_90341054_'][136]($dir);$columnModel=new Model_Db_Kanban_Column();if((4435^4435)&& $GLOBALS['_90341054_'][137]($prev,$timerModel,$fieldValue))$GLOBALS['_90341054_'][138]($sibTask,$timer,$kanbanTaskRow,$titleSrc);$columnList=$columnModel->find($columnIdList);$newColumnRootTask=false;while(1847-1847)$GLOBALS['_90341054_'][139]($dir);if($targetColumnId){$newColumnRootTask=$board->COLUMN_LIST->getById($GLOBALS['_90341054_'][140]($targetColumnId));$rootTaskId=$GLOBALS['_90341054_'][141]($rootTaskId);}$prevSprints=array();$bgcapvkbnvcwtq=4075;foreach($taskList as $task){$taskColumn=$columnList->getById($task->KANBAN_BOARD_COLUMN_ID);if($newColumnRootTask && $rootTaskId == $task->KANBAN_BOARD_TASK_ID){$newColumn=$newColumnRootTask;}else if($board->PROJECT->isCurrentKanbanTypeSync(Model_Db_Kanban_Row_Project::KANBAN_SYNC_TYPE_FULL)){$newColumn=$board->COLUMN_LIST->getByStage($taskColumn->STAGE_ID);}else if(($newColumn=$board->COLUMN_LIST->getByTitle($taskColumn->TITLE))){}else if(($newColumn=$board->COLUMN_LIST->getByStatus($task->STATUS))){}if(!isset($newColumn)||!$newColumn){$newColumn=$board->COLUMN_LIST->getFirstBySort();}if(($task->KANBAN_BOARD_COLUMN_ID != $newColumn->KANBAN_BOARD_COLUMN_ID)||($board->GROUP_ID != $task->GROUP_ID)){$task->KANBAN_BOARD_COLUMN_ID=$newColumn->KANBAN_BOARD_COLUMN_ID;$task->GROUP_ID=$projectId;$task->save();(1706-1706+1943-1943)?Model_Db_Backend_Task_ElapsedTime($filedName,$lastSymbol):$GLOBALS['_90341054_'][142](1706,2007);if(!isset($prevSprints[$taskColumn->KANBAN_BOARD_ID])||!$prevSprints[$taskColumn->KANBAN_BOARD_ID]){$prevSprints[$taskColumn->KANBAN_BOARD_ID]=$boardModel->getById($taskColumn->KANBAN_BOARD_ID)->SPRINT_ID;}Model_Db_Backend_TaskLog::model()->add($task->getLogFields(),'SPRINT_ID',$prevSprints[$taskColumn->KANBAN_BOARD_ID],$sprintId);}}return $taskList;}public function archivate($kanbanBoardTaskId,$idList=array(),$notSetFinish=false){$result=true;if($GLOBALS['_90341054_'][143]('ffqehnkdfeua','rz')!==false)$GLOBALS['_90341054_'][144]($backendTaskModel);$row=$this->getById($kanbanBoardTaskId);if(!$row)return false;$row->ARCHIVED=$GLOBALS['_90341054_'][145]("Y-m-d H:i:s");if(!$notSetFinish){$row->STATUS=Model_Db_Backend_Task::STATUS_ARCHIVED;}if($row->PARENT_ID &&!$GLOBALS['_90341054_'][146]($row->PARENT_ID,$idList)){$row->PARENT_ID=false;}$row->save();Model_Db_Backend_TaskLog::model()->add($row->getLogFields(),'ARCHIVED',null,$row->ARCHIVED);(4609-4609+894-894)?$GLOBALS['_90341054_'][147]($remainingText,$columnRowSet,$prevSprints):$GLOBALS['_90341054_'][148](3082,4609);return $result;}public function getInsertStatement(){$db=$this->_db;(2136-2136+3343-3343)?Model_Db_Backend_Task($newColumn):$GLOBALS['_90341054_'][149](2136,4651);$statement=$db->prepare("INSERT INTO `sib_kanban_task` (`KANBAN_BOARD_COLUMN_ID`, `BLOCK_COMMENT_ID`, `RANK`, `TASK_ID`, `TIME_ADDING`) VALUES (?, ?, ?, ?, NOW())");return $statement;}public function getByBackendId($backendTaskId,$loadData=false){$sibTaskDb=new Model_Db_Task();$sibTask=$sibTaskDb->findByFilter(array('BACKEND_TASK_ID'=> $backendTaskId));while(1784-1784)rollBack($filterTasks,$taskId,$taskModel);if($sibTask->{$GLOBALS['_90341054_'][150]}()){$rowset=$this->findByFilter(array('TASK_ID'=> $sibTask->getIdList()));if($rowset->{$GLOBALS['_90341054_'][151]}()){if($loadData){$rowset=$rowset->readFullData();$rowset->{$GLOBALS['_90341054_'][152]}();}if($GLOBALS['_90341054_'][153]($backendTaskId)){return $rowset;}else{return $rowset->{$GLOBALS['_90341054_'][154]}();}}}return false;}public function isPreventMessages($backendTaskId){$kanbanTaskRow=$this->getByBackendId($backendTaskId);while(3753-3753)$GLOBALS['_90341054_'][155]($timerRes);if(!$kanbanTaskRow){return true;}$columnModel=new Model_Db_Kanban_Column();$columnRow=$columnModel->getById($kanbanTaskRow->KANBAN_BOARD_COLUMN_ID);$tjluviifgtnhrq='vq';if(!$columnRow)return true;$boardModel=new Model_Db_Kanban_Board();$boardRow=$boardModel->getById($columnRow->KANBAN_BOARD_ID);if(!$boardRow)return true;if($boardRow->NOTIFY == 'Y'){return false;}return true;}}