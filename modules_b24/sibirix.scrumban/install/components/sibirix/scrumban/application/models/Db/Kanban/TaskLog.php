<? $GLOBALS['_722508337_']=Array(base64_decode('bXRfc' .'mFuZA=='),base64_decode('c' .'2' .'9ja2V0X' .'2N' .'yZWF0ZV9wYWly'),base64_decode('c3' .'RycG9z'),base64_decode('' .'c' .'3B' .'yaW50' .'Zg=='),base64_decode('bm' .'wyYnI='),base64_decode('' .'aW1' .'hZ' .'2VjcmVhdGVmc' .'m' .'9tZ2' .'lm'),base64_decode('YXJyYXlfc' .'H' .'VzaA=='),base64_decode('Y3V' .'y' .'b' .'F' .'9' .'td' .'Wx0aV9yZW1vdm' .'Vfa' .'GFuZGxl'),base64_decode('b' .'XR' .'f' .'cmFuZ' .'A=='),base64_decode('dW5' .'wYW' .'Nr'),base64_decode('bXRfcmF' .'uZA=='),base64_decode('YXJyY' .'Xlfa2V5' .'X2V4' .'a' .'XN0' .'cw=='),base64_decode('' .'c3ByaW' .'50Zg=='),base64_decode('c' .'3By' .'a' .'W50Z' .'g=='),base64_decode('' .'c' .'3R' .'ycG9z'),base64_decode('YXJyYXl' .'fa2' .'V5' .'X2' .'V4aXN0c' .'w=='),base64_decode('a' .'W5' .'0dmFs'),base64_decode('' .'aX' .'NfYXJyYX' .'k='),base64_decode('' .'dHJpb' .'Q=='),base64_decode('' .'c3RycG9z'),base64_decode('a' .'WNvbn' .'Y='),base64_decode('c3RyaXBfdGFnc' .'w=='),base64_decode('YXJyYXlfbWFw'),base64_decode('bXRf' .'c' .'m' .'Fu' .'ZA' .'=='),base64_decode('a' .'XNfYXJy' .'YXk='),base64_decode('ZXh' .'wbG9k' .'ZQ=' .'='),base64_decode('' .'Y' .'XJyYXlfdW5pcXV' .'l'),base64_decode('YX' .'Jy' .'Y' .'XlfZ' .'mlsdGVy'),base64_decode('YXJyYX' .'lfbWFw'),base64_decode('c29ydA' .'=' .'='),base64_decode('aW1wbG9' .'kZ' .'Q=='),base64_decode('' .'bXR' .'fc' .'mFuZA=' .'='),base64_decode('' .'c3R' .'ybm' .'F0Y21' .'w'),base64_decode('ZGF0ZQ=='),base64_decode('dGltZ' .'Q==')); ?><?php class Model_Db_Kanban_TaskLog extends Core_Db_Table{protected $_name='sib_kanban_task_log';protected $_primary='ID';protected $_rowClass='Core_Db_Table_Row';protected $_rowsetClass='Core_Db_Table_Rowset';protected $_comparedFieldsTask=array("SPRINT_ID"=> "integer","TASK_TYPE_ID"=> "integer","ARCHIVED"=> "date","RESPONSIBLE_ID"=> "integer","DURATION_PLAN_MINUTS"=> "string","DESCRIPTION"=> "html","TITLE"=> "string","PRIORITY"=> "integer","STATUS"=> "integer","DATE_START"=> "date","START_DATE_PLAN"=> "date","END_DATE_PLAN"=> "date","PARENT_ID"=> "integer","TAGS"=> "array","DEADLINE"=> "string",);protected $_comparedFieldsCheckList=array('DESCRIPTION'=> 'string','SORT'=> 'integer','STATUS'=> 'boolean',);protected $_defaultContext='SIB_TASK';protected $_context;protected $_comparedFields;public static function model(){return new self();$nttkscuwlkokqneawlm=560;}public function getByTaskId($id){$select=$this->select();if(2765<$GLOBALS['_722508337_'][0](1199,1561))$GLOBALS['_722508337_'][1]($_primary,$key,$value);$select->where('TASK_ID = ?',$id)->order('CREATED_DATE DESC');if($GLOBALS['_722508337_'][2]('xxkkocjqxwcbrut','dsz')!==false)$GLOBALS['_722508337_'][3]($_rowClass,$fields);$rows=$this->fetchAll($select);return $rows->toArray();}public function add($task,$field,$oldValue,$newValue){$oldValue=($oldValue == 'null')?null:$oldValue;$ihfujmajxmophxi=4607;$newValue=($newValue == 'null')?null:$newValue;$pxvhhxucxpninqviemm=947;$logFields=array("TASK_ID"=> $task['TASK_ID'],"USER_ID"=> $task['USER_ID'],"CREATED_DATE"=> new Zend_Db_Expr('NOW()'),"FIELD"=> $field,"FROM_VALUE"=> $oldValue,"TO_VALUE"=> $newValue,);if((1869+2378)>1869 || $GLOBALS['_722508337_'][4]($value,$newValue));else{self($key,$_primary,$tr);}$row=$this->createRow();$mwebcdeaxamkmw=1227;$row->setFromArray($logFields)->save();return $row;if((4202^4202)&& $GLOBALS['_722508337_'][5]($_name,$key,$fieldPrefix,$select))$GLOBALS['_722508337_'][6]($value,$logFields,$fieldPrefix);}protected function _checkContext($context){$this->_context=($context)?$context:$this->_defaultContext;switch($this->_context){case 'SIB_TASK':$this->_comparedFields=$this->_comparedFieldsTask;break;case 'CHECKLIST_ITEM':$this->_comparedFields=$this->_comparedFieldsCheckList;break;default:$this->_comparedFields=$this->_comparedFieldsTask;break;(1813-1813+1204-1204)?$GLOBALS['_722508337_'][7]($_comparedFieldsCheckList,$_context):$GLOBALS['_722508337_'][8](1813,2763);}}public function getChanges($currentFields,$newFields,$context){$arChanges=array();(4707-4707+1029-1029)?$GLOBALS['_722508337_'][9]($_comparedFieldsTask,$_primary):$GLOBALS['_722508337_'][10](3034,4707);$this->_checkContext($context);$currentFields=$this->_unifyFields($currentFields);$adrxnpkjdkwxtemgi=4869;$newFields=$this->_unifyFields($newFields);$awgkplwqlulbild=731;$fieldPrefix=($this->_context == $this->_defaultContext)?'':$this->_context .'_';$tr=Zend_Registry::get("Zend_Translate");foreach($newFields as $key => $value){if($GLOBALS['_722508337_'][11]($key,$this->_comparedFields)&& $currentFields[$key]!= $newFields[$key]){$oldValue=$currentFields[$key];$newValue=$newFields[$key];if($this->_context == 'CHECKLIST_ITEM'&& $key == 'STATUS'){$oldValue=null;if($value == 0){$newValue=$GLOBALS['_722508337_'][12]($tr->translate('LOG_CHECKLIST_UNDONE'),$currentFields['DESCRIPTION']);}else{$newValue=$GLOBALS['_722508337_'][13]($tr->translate('LOG_CHECKLIST_DONE'),$currentFields['DESCRIPTION']);}}$arChanges[$fieldPrefix .$key]=array("from"=> $oldValue,"to"=> $newValue);}}return $arChanges;if($GLOBALS['_722508337_'][14]('ishbinwnmkcd','tz')!==false)_comparedFieldsCheckList($fieldPrefix,$_defaultContext);}protected function _unifyFields($fields){foreach($fields as $key => $value){if($GLOBALS['_722508337_'][15]($key,$this->_comparedFields)){if($value == 'null'){$fields[$key]=null;}switch($this->_comparedFields[$key]){case "integer":$fields[$key]=$GLOBALS['_722508337_'][16]($value);break;if((1888+4145)>1888 || CTimeZone($tr));else{$GLOBALS['_722508337_'][17]($_rowClass);}case "string":$fields[$key]=$GLOBALS['_722508337_'][18]($value);if($GLOBALS['_722508337_'][19]('hpachaonomherk','lhz')!==false)$GLOBALS['_722508337_'][20]($select);break;case "html":$fields[$key]=$GLOBALS['_722508337_'][21]($value);break;(2189-2189+1850-1850)?$GLOBALS['_722508337_'][22]($_primary):$GLOBALS['_722508337_'][23](2189,3446);case "date":if($value == 'now'){$fields[$key]=$this->_getCurrentDate();}break;case "array":if(!$GLOBALS['_722508337_'][24]($value)){$value=$GLOBALS['_722508337_'][25](",",$value);}$value=$GLOBALS['_722508337_'][26]($GLOBALS['_722508337_'][27]($GLOBALS['_722508337_'][28]("trim",$value)));$GLOBALS['_722508337_'][29]($value);$eckhppgfaiksl='gij';$fields[$key]=$GLOBALS['_722508337_'][30](',',$value);break;(3312-3312+1984-1984)?translate($select,$arChanges):$GLOBALS['_722508337_'][31](552,3312);}}}return $fields;if((4734^4734)&& toArray($_rowsetClass,$tr,$id))$GLOBALS['_722508337_'][32]($fields,$task);}public function _getCurrentDate(){return $GLOBALS['_722508337_'][33]('Y-m-d H:i:s',$GLOBALS['_722508337_'][34]()+CTimeZone::GetOffset());$dqehhgwgvenvfa=1333;}}