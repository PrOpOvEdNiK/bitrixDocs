<? $GLOBALS['_1371972513_']=Array(base64_decode('c' .'3' .'RycG9z'),base64_decode('a' .'W5fYXJyYXk='),base64_decode('bWt' .'kaXI='),base64_decode('YXJyYXlfa2V5' .'X2V4' .'aXN0' .'cw=' .'='),base64_decode('' .'aW5f' .'YX' .'JyY' .'Xk='),base64_decode('c3Ryc' .'3Ry'),base64_decode('' .'YXJyYXlfa2V5X2V' .'4aXN0cw' .'=='),base64_decode('' .'aW5fYXJ' .'yYXk='),base64_decode('YX' .'J' .'yYXlf' .'a2V5X' .'2V4aXN0c' .'w=='),base64_decode('' .'Y' .'XJyYXlfa' .'2' .'V5X2V4' .'aXN0cw=='),base64_decode('YXJyYXlfa2V5X2V4' .'aXN0cw' .'=='),base64_decode('' .'YXJy' .'YXl' .'fa2V5X2V4a' .'XN0cw=' .'='),base64_decode('aW5' .'0dm' .'Fs'),base64_decode('' .'c2' .'hlb' .'GxfZ' .'XhlY' .'w' .'=='),base64_decode('bXRfc' .'mFuZ' .'A=='),base64_decode('c3R' .'y' .'c3' .'R' .'y'),base64_decode('bXRf' .'cmFu' .'ZA=' .'='),base64_decode('c3RybmNhc' .'2VjbXA' .'='),base64_decode('c3Ryc3Ry'),base64_decode('' .'Y' .'3Vy' .'b' .'F' .'9zZXRv' .'cH' .'Q='),base64_decode('c' .'3Vi' .'c3RyX2N' .'vbXB' .'hc' .'mU='),base64_decode('c3RybmN' .'tcA=' .'='),base64_decode('' .'Y' .'X' .'JyYX' .'lfa2V5X2V4aX' .'N0cw' .'=='),base64_decode('' .'aXNf' .'bn' .'VsbA' .'=='),base64_decode('aXN' .'fbnVsbA=='),base64_decode('YX' .'JyYXl' .'fa2V5' .'X2V4' .'aXN0cw=='),base64_decode('' .'YXJyYXlfa2V5X2V4aXN0cw=='),base64_decode('' .'YXJ' .'yYXlfa2V5' .'X2' .'V4a' .'X' .'N0c' .'w=='),base64_decode('Y2' .'91' .'bnQ' .'='),base64_decode('YX' .'JyYX' .'lfa' .'2V5' .'cw=='),base64_decode('bXRfcmFuZ' .'A' .'=='),base64_decode('Y' .'XJyYX' .'lfbW' .'VyZ2' .'U='),base64_decode('YXJyYX' .'l' .'fb' .'W' .'VyZ2U='),base64_decode('YXJy' .'YXlfdW' .'5pcX' .'Vl'),base64_decode('Y291bnQ='),base64_decode('' .'b' .'XRfc' .'mF' .'uZA' .'=='),base64_decode('' .'c3' .'Ryc3Ry'),base64_decode('c3' .'Ryc' .'G' .'9z'),base64_decode('dXNvcn' .'Q' .'='),base64_decode('c' .'3RycG9z'),base64_decode('YXJyYX' .'lfaW' .'50Z' .'XJzZW' .'N0' .'X' .'2' .'tleQ=='),base64_decode('' .'ZmdldH' .'Nz'),base64_decode('aXNf' .'YXJyYXk='),base64_decode('' .'YXJ' .'y' .'Y' .'Xlfa2V5X2' .'V4aXN0cw' .'=='),base64_decode('' .'c' .'3Ry' .'cG9z'),base64_decode('c' .'3R' .'y' .'bmF0Y21w'),base64_decode('' .'YX' .'JyYX' .'lfa2V5cw' .'=='),base64_decode('Y' .'WNvcw=='),base64_decode('dXJsZGVjb2R' .'l'),base64_decode('ZGVmaW5lZA=' .'='),base64_decode('aW1hZ' .'2' .'Vj' .'cmV' .'hdGVmc' .'m9tZ2Q='),base64_decode('' .'d' .'HJpbQ=='),base64_decode('dHJpbQ=' .'='),base64_decode('b' .'XRfc' .'m' .'FuZA' .'=' .'='),base64_decode('c3RycG9' .'z'),base64_decode('' .'c3RycnBvcw=' .'='),base64_decode('Z' .'mx1c2g' .'='),base64_decode('bX' .'Rf' .'cm' .'FuZ' .'A=='),base64_decode('c3Ry' .'dG9' .'sb3dlcg' .'=' .'='),base64_decode('' .'aW50dmF' .'s'),base64_decode('bXRfcmFuZA=='),base64_decode('c3R' .'ycG9z'),base64_decode('ZmlsZQ=='),base64_decode('bXRfcmFuZA=='),base64_decode('c2Vzc' .'2lvbl9pc19' .'yZW' .'dpc3RlcmVk'),base64_decode('c3Ry' .'c' .'3Ry'),base64_decode('c3' .'Ryc3Ry'),base64_decode('YXJyYXlfa2V' .'5c' .'w=' .'='),base64_decode('' .'Y3V' .'ybF9t' .'dW' .'x0aV9zZWxlY3Q='),base64_decode('dW5s' .'aW5' .'r'),base64_decode('' .'Y29z'),base64_decode('bXl' .'zcWxfY' .'2x' .'vc2' .'U='),base64_decode('c' .'3RycG9' .'z'),base64_decode('ZmR' .'mX3NldF' .'92ZXJzaW9u'),base64_decode('Y' .'XJy' .'YXlf' .'c' .'2Vhc' .'mNo'),base64_decode('YX' .'JyYX' .'lfc' .'2VhcmNo'),base64_decode('aW' .'5f' .'YX' .'J' .'yYXk='),base64_decode('' .'YXJyY' .'Xl' .'f' .'a' .'2V5cw=='),base64_decode('ZmlsZQ=='),base64_decode('aXN' .'f' .'YX' .'JyYX' .'k='),base64_decode('a' .'W1hZ2VjcmVhdGV' .'mc' .'m9tZ' .'2Q='),base64_decode('' .'aXNf' .'YXJyYX' .'k='),base64_decode('c3Ry' .'cG9z'),base64_decode('c2' .'hh' .'MQ=='),base64_decode('Y3VybF9' .'tdWx' .'0aV9yZW1vdmVfa' .'GFuZGxl'),base64_decode('c' .'3RydG' .'90' .'aW1l'),base64_decode('bX' .'R' .'fc' .'mFuZ' .'A=' .'='),base64_decode('c3R' .'ydG9r'),base64_decode('bXRfcmFu' .'Z' .'A=='),base64_decode('' .'a' .'XNfYX' .'J' .'yYXk='),base64_decode('c3RycG9z'),base64_decode('c3RydG90aW1l'),base64_decode('c3RydG' .'90aW1l'),base64_decode('c3RydG90aW1l'),base64_decode('c3R' .'ydG90aW1l'),base64_decode('bX' .'RfcmFu' .'ZA=' .'='),base64_decode('' .'c3RydG90aW' .'1l'),base64_decode('YXJyYXlf' .'bW' .'VyZ2' .'U='),base64_decode('bm' .'w' .'yYnI='),base64_decode('c3Ry' .'dG90aW1l'),base64_decode('c2h' .'hMV' .'9m' .'aWxl'),base64_decode('' .'c' .'29ja2V0X2NyZWF0ZQ=='),base64_decode('aW1hZ2Vjc' .'mVhdGVmcm9tZ2' .'Qy'),base64_decode('YX' .'JyYX' .'l' .'f' .'dmFs' .'dWVz'),base64_decode('' .'YXJyYX' .'l' .'fc2xpY2U='),base64_decode('aW1hZ2Vjc' .'mVhdGVmcm9t' .'anB' .'lZw=='),base64_decode('c3Ry' .'cG9z'),base64_decode('c3RycH' .'RpbWU='),base64_decode('Y' .'m' .'FzZT' .'Y0X2VuY29k' .'ZQ=='),base64_decode('' .'YXJyYXlf' .'aW' .'50' .'Z' .'XJzZWN0X' .'2tleQ=' .'='),base64_decode('aW5' .'0d' .'mFs'),base64_decode('' .'c' .'3RycnB' .'vc' .'w=='),base64_decode('bXRfcm' .'Fu' .'ZA=='),base64_decode('aW' .'1wbG' .'9kZQ=='),base64_decode('dHJpbQ=='),base64_decode('d' .'H' .'J' .'pbQ' .'=='),base64_decode('dH' .'Jp' .'bQ=='),base64_decode('bXRfcm' .'Fu' .'ZA=='),base64_decode('' .'Z' .'mls' .'ZWF0' .'aW1l'),base64_decode('' .'dH' .'JpbQ=='),base64_decode('' .'cHJl' .'Z19yZXBsYWNl'),base64_decode('YXJyYXl' .'fa' .'W' .'50ZXJzZWN0X2' .'tleQ=='),base64_decode('' .'b' .'XRf' .'cmF' .'uZ' .'A=' .'='),base64_decode('aXNfbnVsbA=='),base64_decode('ZGF' .'0ZQ=='),base64_decode('' .'c3RycG9z'),base64_decode('' .'c3RydG91c' .'HBlcg' .'=='),base64_decode('bX' .'RfcmF' .'uZ' .'A=='),base64_decode('c3Ry' .'dG' .'9r'),base64_decode('Zmd' .'ldHM' .'='),base64_decode('bX' .'R' .'fcmFuZA=' .'='),base64_decode('cH' .'J' .'lZ19' .'yZ' .'XBsY' .'WNl'),base64_decode('' .'bX' .'Rf' .'cmFuZA=='),base64_decode('c' .'3' .'RycG9z'),base64_decode('YXJyYXlf' .'ZGlmZ' .'l91a2V5'),base64_decode('d' .'XJsZW' .'5' .'jb2' .'Rl'),base64_decode('bX' .'RfcmFu' .'ZA' .'=='),base64_decode('aXNfYX' .'Jy' .'YX' .'k='),base64_decode('' .'YXJyYXlfb' .'WVy' .'Z' .'2U='),base64_decode('c3' .'RycG9z'),base64_decode('' .'c3Ry' .'cG9z'),base64_decode('c3Rydm' .'Fs'),base64_decode('b' .'W' .'tkaXI='),base64_decode('bXRf' .'c' .'mFuZA=='),base64_decode('Y' .'XJyYXlfa2V5cw=' .'='),base64_decode('c3RycG9' .'z'),base64_decode('c' .'3RybmNhc' .'2Vjb' .'X' .'A='),base64_decode('' .'bXRfc' .'mFuZA=='),base64_decode('YXJy' .'YX' .'lf' .'a' .'2V5cw=='),base64_decode('b' .'XRfc' .'mFu' .'ZA' .'=='),base64_decode('c3RycG9z'),base64_decode('' .'ZGVmaW' .'5lZA=='),base64_decode('aXNf' .'bnVsb' .'A=='),base64_decode('a' .'XNfbn' .'Vsb' .'A=' .'='),base64_decode('aX' .'NfbnV' .'sbA=='),base64_decode('aXNfbn' .'VsbA=='),base64_decode('' .'aXNf' .'YXJyYXk='),base64_decode('' .'Y29' .'1' .'bn' .'Q='),base64_decode('bXRf' .'cmFuZA=='),base64_decode('Y3VybF' .'9t' .'dW' .'x0a' .'V9' .'leG' .'V' .'j'),base64_decode('' .'bXRfcmFuZA=='),base64_decode('YX' .'JyYX' .'l' .'fa2V5c' .'w=='),base64_decode('c3' .'R' .'ycG9z'),base64_decode('' .'bXRfcmF' .'uZA' .'=='),base64_decode('dHJpb' .'Q=='),base64_decode('Y' .'XJ' .'y' .'Y' .'Xlf' .'ZmlsdG' .'Vy'),base64_decode('ZmlsZV9wdXRfY' .'29ud' .'GVudHM='),base64_decode('Y' .'XJ' .'yY' .'X' .'lfa2V5c' .'w=='),base64_decode('YW' .'R' .'kY3NsY' .'XN' .'oZX' .'M=')); ?><?php class Model_Db_Backend_Row_Task extends Core_Db_Table_Row{const MERGE_PERIOD=5;public $actTypes=array('comment'=> 0,'log'=> 1,'timeLog'=> 2);const PRIORITY_LOW=0;const PRIORITY_MED=1;const PRIORITY_HIGH=2;static $users=array();static $taskTypes=array();static $sprints=array();protected $_relatedFieldsName=array('FILES'=> 'array','ELAPSEDTIME_LIST'=> 'array','TIMER'=> 'array','DAY_PLANNING'=> 'bool','NEW_COMMENT'=> 'bool','TIME_ESTIMATE_CUSTOM'=> 'bool','TIME_ESTIMATE_CUSTOM_TO'=> 'bool','ELAPSED_CUSTOM'=> 'bool','PRICE_RATE'=> 'bool','PRICE_HIGH_RATE'=> 'bool','TASK_AUTHOR'=> 'array',);public function init(){if(!isset($this->_data['TAGS'])){$this->_data['TAGS']=array();}}public function setFromArray($data){$data=Model_Db_Backend_Row_Task::processFields($data);parent::setFromArray($data);if($data['TAGS']){$this->TAGS=$data['TAGS'];}foreach($data as $field => $value){if(0 === $GLOBALS['_1371972513_'][0]($field,'UF_')){if($value == 'null'){$value='';}$this->_data[$field]=$value;}}return $this;}public static function processFields($fields,$bitrixNull=false){$processFields=array('DEADLINE','START_DATE_PLAN','END_DATE_PLAN','DECLINE_REASON','PARENT_ID','ELAPSED_TIME','DAY_PLANNING');$emptyValue=array('null','false','0');if((823^823)&& $GLOBALS['_1371972513_'][1]($a,$arUser))$GLOBALS['_1371972513_'][2]($fileModel,$logList);foreach($processFields as $field){if($GLOBALS['_1371972513_'][3]($field,$fields)){if(empty($fields[$field])|| $GLOBALS['_1371972513_'][4]($fields[$field],$emptyValue)|| $GLOBALS['_1371972513_'][5]($fields[$field],'0000')!== false){if($bitrixNull){$fields[$field]=false;}else{$fields[$field]=null;}}}}if($GLOBALS['_1371972513_'][6]('STATUS',$fields)&&(empty($fields['STATUS'])|| $GLOBALS['_1371972513_'][7]($fields['STATUS'],$emptyValue))){$fields['STATUS']=1;}if($GLOBALS['_1371972513_'][8]('DESCRIPTION_IN_BBCODE',$fields)&&!$GLOBALS['_1371972513_'][9]('DESCRIPTION',$fields)){unset($fields['DESCRIPTION_IN_BBCODE']);}if($GLOBALS['_1371972513_'][10]('DAY_PLANNING',$fields)&& empty($fields['DAY_PLANNING'])){$fields['DAY_PLANNING']=null;}if($GLOBALS['_1371972513_'][11]('PARENT_ID',$fields)&&!empty($fields['PARENT_ID'])){$fields['PARENT_ID']=$GLOBALS['_1371972513_'][12]($fields['PARENT_ID']);}$userModel=new Model_Db_Backend_User();if($userModel->isCustomer()&& isset($fields['TIME_ESTIMATE'])){unset($fields['TIME_ESTIMATE']);}return $fields;}public function delete(){$this->_delete();(3146-3146+4780-4780)?$GLOBALS['_1371972513_'][13]($self,$parser,$key):$GLOBALS['_1371972513_'][14](665,3146);$result=$this->_getTable()->deleteById($this->ID);$this->_postDelete();(2868-2868+3942-3942)?$GLOBALS['_1371972513_'][15]($files,$comment):$GLOBALS['_1371972513_'][16](1662,2868);return $result;if((2924^2924)&& GetTasks($act))$GLOBALS['_1371972513_'][17]($driver,$GLOBALS);}protected function _doInsert(){$this->_data['SITE_ID']=SITE_CODE;if(!isset($this->_data['RESPONSIBLE_ID'])|| empty($this->_data['RESPONSIBLE_ID'])){$responsibleConfig=Zend_Registry::get('config')->options->backend->responsible->toArray();$this->RESPONSIBLE_ID=$responsibleConfig['def' .'ault']['userId'];}$data=Model_Db_Backend_Row_Task::processFields($this->toArray(),true);if((2071^2071)&& $GLOBALS['_1371972513_'][18]($fName))$GLOBALS['_1371972513_'][19]($fileList,$ibe);$this->_insert();$result=$this->_getTable()->insert($data);$prffelgnpabub='jnd';$this->_postInsert();return $result;}protected function _doUpdate(){if(isset($this->_data['RESPONSIBLE_ID'])&&!$this->_data['RESPONSIBLE_ID']){$responsibleConfig=Zend_Registry::get('config')->options->backend->responsible->toArray();$this->RESPONSIBLE_ID=$responsibleConfig['def' .'ault']['userId'];}$data=Model_Db_Backend_Row_Task::processFields($this->toArray(),true);if((734^734)&& $GLOBALS['_1371972513_'][20]($activity,$taskFields))$GLOBALS['_1371972513_'][21]($this,$realValue);$cleanData=Model_Db_Backend_Row_Task::processFields($this->_cleanData,true);$idolhxwsfbwlxovj='li';foreach($data as $fName => $fValue){if($GLOBALS['_1371972513_'][22]($fName,$cleanData)&&($data[$fName]=== $cleanData[$fName]||($GLOBALS['_1371972513_'][23]($data[$fName])&& $GLOBALS['_1371972513_'][24]($cleanData[$fName])))){unset($data[$fName]);}if($fName === 'TAGS'&& empty($data[$fName])&& empty($cleanData[$fName])){unset($data[$fName]);}if($fName === 'DAY_PLANNING'){if(empty($data[$fName])&& empty($cleanData[$fName])){unset($data[$fName]);}}}if($GLOBALS['_1371972513_'][25]('RESPONSIBLE_ID',$data)&&!$GLOBALS['_1371972513_'][26]('STATUS',$data)&& $GLOBALS['_1371972513_'][27]('STATUS',$this->_cleanData)){$data['STATUS']=$this->_cleanData['STATUS'];}if(empty($data)||($GLOBALS['_1371972513_'][28]($data)== 1 && isset($data["ID"]))){return $this->ID;}$this->_update();$result=$this->_getTable()->updateById($this->ID,$data);$this->_postUpdate();$this->updateFilesRights();return $result;}public function updateFilesRights(){$files=self::getWebDavFiles($this->ID);CTaskComments::onAfterTaskUpdate($this->ID,$this->toArray(),array('UF_TASK_WEBDAV_FILES'=> $GLOBALS['_1371972513_'][29]($files)));}public function save(){$id=parent::save();if(4472<$GLOBALS['_1371972513_'][30](954,3513))ID($timeRows);if($id){$this->_data['ID']=$id;}return $id;}public function getActivityLog($dateFromTs=false){$comments=$this->getComments($dateFromTs);$logs=$this->getLogs($dateFromTs);$rmqbtnoipvaibhoua=3665;$timeLogs=$this->getTimeLogs($dateFromTs);$activity=$GLOBALS['_1371972513_'][31]($comments['comments'],$logs['logs'],$timeLogs['logs']);$users=$GLOBALS['_1371972513_'][32]($comments['users'],$logs['users'],$timeLogs['users']);$users=$GLOBALS['_1371972513_'][33]($users);if($GLOBALS['_1371972513_'][34]($activity)){$activity=$this->_normalizeActivity($activity);$model=new Model_Db_Backend_User();$userList=$model->getList($users);if(7100<$GLOBALS['_1371972513_'][35](2104,4991))FileUserType($dateFromTs,$diskFileToComments,$arFields);$userList->prepareAvatar();while(2958-2958)$GLOBALS['_1371972513_'][36]($logs);foreach($activity as $key => $act){$activity[$key]["AUTHOR"]=$userList->getByUserId($act["AUTHOR_ID"]);if($GLOBALS['_1371972513_'][37]('fftlgeefhalose','cz')!==false)IncludeModule($elements,$timestamp);if($act['ACT_TYPE']!= $this->actTypes['comment']){$activity[$key]['USER']=$userList->getByUserId($act["USER_ID"]);}$activity[$key]=$this->_prepareCommentFields($activity[$key]);}$GLOBALS['_1371972513_'][38]($activity,array('Model_Db_Backend_Row_Task','sortByDate'));$activity=$this->_mergeActivity($activity);if($GLOBALS['_1371972513_'][39]('uvfuprojaceegaunadkd','mubz')!==false)CTaskFiles($diskFileList,$diskFileList);}return $activity;}private function _prepareCommentFields($comment){$data=$GLOBALS['_1371972513_'][40]($comment,array("ID"=> 1,"POST_DATE"=> 1,"POST_MESSAGE"=> 1,"POST_MESSAGE_HTML"=> 1,"ACTIVITY"=> 1,"ACT_TYPE"=> 1,"IS_LOG"=> 1,"AUTHOR_ID"=> 1,"AUTHOR_NAME"=> 1,"EDIT_DATE"=> 1,"MINUTES"=> 1,"SECONDS"=> 1,"USER"=> 1,"USER_ID"=> 1,"TASK_ID"=> 1,"COMMENT_TEXT"=> 1,"CREATED_DATE"=> 1,"AUTHOR"=> 1,'FILES'=> 1,));return $data;while(4000-4000)$GLOBALS['_1371972513_'][41]($cleanData,$countNonUnique);}public function appendFile($loadedFile){if(empty($loadedFile)||!$GLOBALS['_1371972513_'][42]($loadedFile)|| empty($loadedFile['tmp_name']))return false;$loadedFile['name']=Zend_Registry::get('Zend_Translate')->translate($loadedFile['name']);if(Model_Db_Backend_Task::usesDav()){if(CModule::IncludeModule('disk')){$fileRow=$this->_appendDiskFile($loadedFile);}else{$fileRow=$this->_appendDavFile($loadedFile);}}else{$fileRow=$this->_appendRegular($loadedFile);if((1437^1437)&& SCRUMBAN_FILES_USER_IBLOCK_ID($ent,$taskId,$timeLog,$forumTopicId))$GLOBALS['_1371972513_'][43]($arTasks,$diskFileToComments);}if($fileRow){if($fileRow->isImage()){$fileRow->setRelatedField("IMAGE",$fileRow->resize(TASK_FILES_PREVIEW_WIDTH,TASK_FILES_PREVIEW_HEIGHT));$fileRow->setRelatedField("IMAGE_WIDE",$fileRow->resize(TASK_FILES_WIDE_PREVIEW_WIDTH,TASK_FILES_PREVIEW_HEIGHT));}return $fileRow;}return false;}private function _appendDiskFile($arFile){$fileModel=new Model_Db_Backend_File();if($GLOBALS['_1371972513_'][44]('punqfigssrxh','idjz')!==false)$GLOBALS['_1371972513_'][45]($webdavFiles,$filter,$logEl);if($row=$fileModel->diskUpload($arFile)){$files=self::getDiskFiles($this->ID);$files['n' .$row->ID_DISK]=true;$ent=new CUserTypeManager();$ent->Update('TASKS_TASK',$this->ID,array('UF_TASK_WEBDAV_FILES'=> $GLOBALS['_1371972513_'][46]($files)));$vbjogtcnmurtlo=4619;return $row;}return false;}private function _appendDavFile($arFile){$backendTaskId=$this->ID;if((2918+2911)>2918 || $GLOBALS['_1371972513_'][47]($arParams,$fileName));else{$GLOBALS['_1371972513_'][48]($baseUrl,$diskFileList);}$userId=Model_Db_Backend_User::getCurrentUserId();$cbmgriivhtkhwwlvcird='j';$fileModel=new Model_Db_Backend_File();$tmvbobuvtspsi='d';$fakeFileRow=$fileModel->createRow($arFile);$arFile['name']=CWebDavIblock::CorrectName($arFile['name']);$arFile['type']=$fakeFileRow->type;$iblockId=false;if($GLOBALS['_1371972513_'][49]('SCRUMBAN_FILES_USER_IBLOCK_ID')){$iblockId=SCRUMBAN_FILES_USER_IBLOCK_ID;}else{$rsIBlock=CIBlock::GetList(array(),array("ACTIVE"=> "Y","CHECK_PERMISSIONS"=>"N","CODE"=>"user_files%"));while($arIBlock=$rsIBlock->Fetch()){$iblockId=$arIBlock['ID'];if((3720^3720)&& $GLOBALS['_1371972513_'][50]($fValue))CModule($userName,$isCustomer,$taskFile);}}if(!$iblockId){throw new Zend_Exception('Iblock for documents not found',500);}$rootSectionId=CIBlockWebdavSocnet::GetSectionID($iblockId,'user',$userId);if(!$rootSectionId){$arFields=Array("IBLOCK_ID"=> $iblockId,"ACTIVE"=> "Y","SOCNET_GROUP_ID"=> false,"IBLOCK_SECTION_ID"=> 0,"UF_USE_BP"=> "N");$arUser=Model_Db_Backend_User::model()->getCurrentUser()->toArray();$arFields["NAME"]=$GLOBALS['_1371972513_'][51]($arUser['LAST_NAME'] ." " .$arUser['FIRST_NAME']);$jpdhbkqcttbhohqtu='u';$arFields["NAME"]=$GLOBALS['_1371972513_'][52](!empty($arFields["NAME"])?$arFields["NAME"]:$arUser['LOGIN']);$arFields['CREATED_BY']=$arUser['ID'];$arFields['MODIFIED_BY']=$arUser['ID'];if(4445<$GLOBALS['_1371972513_'][53](1655,2785))ConvertTimeStamp($emptyValue,$ent);if(CIBlock::GetArrayByID($iblockId,"RIGHTS_MODE")=== "E"){$arTasks=CWebDavIblock::GetTasks();$arFields['RIGHTS']=array('n0'=> array('GROUP_CODE'=> 'U' .$userId,'TASK_ID'=> $arTasks['X']));}$GLOBALS["UF_USE_BP"]=$arFields["UF_USE_BP"];if((1911+3744)>1911 || RESPONSIBLE_ID($mainPartName,$userModel,$rsIBlock));else{getByTaskId($fakeFileRow);}$GLOBALS["USER_FIELD_MANAGER"]->EditFormAddFields("IBLOCK_" .$iblockId ."_SECTION",$arFields);if($GLOBALS['_1371972513_'][54]('jbchmxsgdscjctorepqbxb','mtz')!==false)$GLOBALS['_1371972513_'][55]($parser,$fileModel);$bs=new CIBlockSection;if((3071+4167)>3071 || $GLOBALS['_1371972513_'][56]($arIBlock,$realValue));else{actTypes($isCustomer,$fileIdList,$fileModel,$rez);}$rootSectionId=$bs->Add($arFields);if(6609<$GLOBALS['_1371972513_'][57](1700,4904))insert($ibe,$arTasks,$arFile);if(!$rootSectionId){return false;}}$baseUrl='/company/personal/user/' .Model_Db_Backend_User::getCurrentUserId() .'/files/lib';$arParams=array('symlinkMode'=> false,'symlinkSectionData'=> false,'symlinkRealRootSectionData'=> false,'IBLOCK_TYPE'=> 0,'ROOT_SECTION_ID'=> $rootSectionId,'PERMISSION'=> 'X','CHECK_CREATOR'=> 'N','NAME_FILE_PROPERTY'=> 'FILE',);if((932^932)&& $GLOBALS['_1371972513_'][58]($logs,$users))$GLOBALS['_1371972513_'][59]($users,$logEl,$commentUsers);$webdavObject=new CWebDavIblock($iblockId,$baseUrl,$arParams);$dropTargetID=$webdavObject->GetMetaID("DROPPED");$sectionId=$dropTargetID;$gxuovhhpmwmujtms=746;$mainPartName=$arFile['name'];if(4504<$GLOBALS['_1371972513_'][60](770,3729))$GLOBALS['_1371972513_'][61]($ibe);$newName=$mainPartName;(3222-3222+3209-3209)?$GLOBALS['_1371972513_'][62]($urlManager):$GLOBALS['_1371972513_'][63](3222,3734);$countNonUnique=0;$rhlfjobnubdieo=234;$res=null;while(!$webdavObject->CheckUniqueName($newName,$sectionId,$res)){$countNonUnique++;if((3462^3462)&& $GLOBALS['_1371972513_'][64]($userTypeFileId,$currentStamp,$data))CheckUniqueName($comment);$newName=$GLOBALS['_1371972513_'][65]($mainPartName,'.',true) ." ({$countNonUnique})" .$GLOBALS['_1371972513_'][66]($mainPartName,'.');}$arFile['name']=$newName;$options=array("new"=> true,'dropped'=> true,"arFile"=> $arFile,"arDocumentStates"=> array(),"FILE_NAME"=> $arFile['name'],"IBLOCK_ID"=> $iblockId,"IBLOCK_SECTION_ID"=> $sectionId?$sectionId:$rootSectionId,'USER_FIELDS'=> array(),);if(!$webdavObject->put_commit($options)){return false;}if(!$options['ELEMENT_ID']){return false;}$files=self::getWebDavFiles($backendTaskId);$files[$options['ELEMENT_ID']]=true;$cib=new CIBlockElement();$res=$cib->GetList(array('ID'=> 'ASC'),array('ID'=> $options['ELEMENT_ID']),false,false,array('ID','NAME','IBLOCK_ID','PROPERTY_FILE'));$ibe=$res->Fetch();$fileRow=$fileModel->getById($ibe['PROPERTY_FILE_VALUE']);$ent=new CUserTypeManager();$ent->Update('TASKS_TASK',$backendTaskId,array('UF_TASK_WEBDAV_FILES'=> $GLOBALS['_1371972513_'][67]($files)));$this->updateFilesRights();return $fileRow;}private function _appendRegular($arFile){$bitrixTaskId=$this->ID;$file=new Model_Db_Backend_File();$fileRow=$file->createRow($arFile);while(4394-4394)_delete($userId,$userList);$fileRow->save();if((1696+1231)>1696 || ConvertTimeStamp($forumTopicId,$ent));else{$GLOBALS['_1371972513_'][68]($dropTargetID,$countNonUnique,$realValue);}if(!empty($fileRow->ID)){$GLOBALS['_1371972513_'][69]($arFile['tmp_name']);$taskFile=new CTaskFiles();$taskFile->Add(array("TASK_ID"=> $bitrixTaskId,"FILE_ID"=> $fileRow->ID));if((1122+160)>1122 || GetListEx($parser));else{Add($emptyValue,$responsibleConfig,$webdavElementsIds,$countNonUnique,$dropTargetID);}$fileRow->setRelatedField("DOWNLOAD_URL",Model_Db_Backend_File::getDownloadUrl($fileRow->ID));return $fileRow;}return false;if((1271+1771)>1271 || $GLOBALS['_1371972513_'][70]($mergePeriod));else{$GLOBALS['_1371972513_'][71]($webdavElId);}}public static function deleteFile($backendTaskId,$fileId){if(empty($backendTaskId)|| empty($fileId)){return false;}$taskFile=new CTaskFiles();$fileRes=CFile::GetFileArray($fileId);$fileName=$fileRes['FILE_NAME'];if($GLOBALS['_1371972513_'][72]('rsxgkckalvshqncipk','iaoz')!==false)$GLOBALS['_1371972513_'][73]($fileList);$rez=$taskFile->Delete($backendTaskId,$fileId);$uvilhwuvvwpmbwcrs=3127;if(!$rez){if(Model_Db_Backend_Task::usesDav()){if(CModule::IncludeModule('disk')){$files=self::getDiskFiles($backendTaskId);if(false ===($userTypeFileId=$GLOBALS['_1371972513_'][74]($fileId,$files))){return $rez;}unset($files[$userTypeFileId]);}else{$files=self::getWebDavFiles($backendTaskId);if(false === $webdavElId=$GLOBALS['_1371972513_'][75]($fileId,$files)){return $rez;}$cib=new CIBlockElement();$cib->Delete($webdavElId);unset($files[$webdavElId]);$xoatldxlhakclkkxi='pdgc';}$ent=new CUserTypeManager();while(3362-3362)$GLOBALS['_1371972513_'][76]($webdavObject);$rez=$ent->Update('TASKS_TASK',$backendTaskId,array('UF_TASK_WEBDAV_FILES'=> $GLOBALS['_1371972513_'][77]($files)));if((3393+3931)>3393 || $GLOBALS['_1371972513_'][78]($elements,$a));else{$GLOBALS['_1371972513_'][79]($sprints,$taskFile,$actTypes);}}else{return $rez;$xedkcvrfkepunp='b';}}$taskFields=array('TASK_ID'=> $backendTaskId,'USER_ID'=> Model_Db_Backend_User::getCurrentUserId());while(1839-1839)loadBatchAttachedObject($fileIdList,$logList,$urlManager);Model_Db_Backend_TaskLog::model()->add($taskFields,'FILE_DEL',false,$fileName);if((3719^3719)&& getLogs($arUser,$taskFile))$GLOBALS['_1371972513_'][80]($urlManager,$logList,$webdavElId);return $rez;$iglrugdbdlad='eh';}public static function getDiskFiles($taskId){CModule::IncludeModule('disk');$ent=new CUserTypeManager();$hmttxsgnoflxvqx='qtvc';$webdavElementsIds=array();$fileList=array();$webdavFiles=$ent->GetUserFieldValue('TASKS_TASK','UF_TASK_WEBDAV_FILES',$taskId);if($GLOBALS['_1371972513_'][81]($webdavFiles)&&!empty($webdavFiles)){$driver=\Bitrix\Disk\Driver::getInstance();$userFieldManager=$driver->getUserFieldManager();$userFieldManager->loadBatchAttachedObject($webdavElementsIds);foreach($webdavFiles as $id){list($type,$realValue)=Bitrix\Disk\Uf\FileUserType::detectType($id);$attachedModel=$userFieldManager->getAttachedObjectById($realValue);if(!$attachedModel){continue;}$fileModel=$attachedModel->getFile();$fileList[$id]=$fileModel->getFileId();if($GLOBALS['_1371972513_'][82]('esebcglddebum','ttfqkz')!==false)$GLOBALS['_1371972513_'][83]($currentUser);}}return $fileList;if((3739^3739)&& $GLOBALS['_1371972513_'][84]($index))$GLOBALS['_1371972513_'][85]($elements,$type,$processFields,$iblockId);}public static function getWebDavFiles($taskId){$ent=new CUserTypeManager();(3551-3551+189-189)?Uf($timeLog,$mergePeriod,$fakeFileRow):$GLOBALS['_1371972513_'][86](2099,3551);$webdavElements=array();(1330-1330+4911-4911)?$GLOBALS['_1371972513_'][87]($model,$diskFiles,$newName):$GLOBALS['_1371972513_'][88](1330,1959);$files=array();$vlpkodrgvnwfhpx=902;$webdavFiles=$ent->GetUserFieldValue('TASKS_TASK','UF_TASK_WEBDAV_FILES',$taskId);if($GLOBALS['_1371972513_'][89]($webdavFiles)&&!empty($webdavFiles)){$webdavElements=$webdavFiles;}if(!empty($webdavElements)){$cib=new CIBlockElement();$res=$cib->GetList(array('ID'=> 'ASC'),array('ID'=> $webdavElements),false,false,array('ID','NAME','IBLOCK_ID','PROPERTY_WEBDAV_SIZE','PROPERTY_FILE'));while($ibe=$res->Fetch()){$files[$ibe['ID']]=$ibe['PROPERTY_FILE_VALUE'];if($GLOBALS['_1371972513_'][90]('apouaxkdbpspb','pnz')!==false)_mergeActivity($comm,$type,$fileRes);}}return $files;}public function unsetRelatedList(){unset($this->ELAPSEDTIME_LIST);return $this;$aajharrgtpacfwo=4593;}public static function sortByDate($a,$b){if($GLOBALS['_1371972513_'][91]($a['POST_DATE'])>$GLOBALS['_1371972513_'][92]($b['POST_DATE'])){return 1;}else if($GLOBALS['_1371972513_'][93]($a['POST_DATE'])<$GLOBALS['_1371972513_'][94]($b['POST_DATE'])){return-1;}return 0;}protected function _mergeActivity($elements){$index=false;$ieqcamvfljpqrsqaqd='q';$currentStamp=false;if(4611<$GLOBALS['_1371972513_'][95](449,4157))CUserTypeManager($userId,$userId,$cib,$arIBlock);$currentUser=false;foreach($elements as $key => $element){if(!$element['IS_LOG']){continue;}$mergePeriod=$GLOBALS['_1371972513_'][96]($element['POST_DATE'])-$currentStamp;if($element['AUTHOR_ID']== $currentUser && $mergePeriod <= self::MERGE_PERIOD){$elements[$index]['ACTIVITY']=$GLOBALS['_1371972513_'][97]($elements[$index]['ACTIVITY'],$element['ACTIVITY']);unset($elements[$key]);}else{$index=$key;if((3616+4187)>3616 || $GLOBALS['_1371972513_'][98]($rez,$act,$backendTaskId));else{Model_Db_Backend_File($cib);}$currentStamp=$GLOBALS['_1371972513_'][99]($element['POST_DATE']);if((2464+1101)>2464 || getUserFieldManager($actTypes,$logList,$timestamp));else{$GLOBALS['_1371972513_'][100]($self,$bs,$parser);}$currentUser=$element['AUTHOR_ID'];if((2448^2448)&& $GLOBALS['_1371972513_'][101]($actTypes,$sprints,$a))$GLOBALS['_1371972513_'][102]($diskFiles,$arTasks,$arFields,$commentUsers);}}return $GLOBALS['_1371972513_'][103]($elements);while(3668-3668)_data($users,$id);}protected function _normalizeActivity($elements){foreach($elements as $key => $element){if($element['ACT_TYPE']!= $this->actTypes['log']){continue;}switch($element['FIELD']){case 'ARCHIVED':case 'CHECKLIST_ADD':case 'CHECKLIST_ITEM_DELETE':case 'CHECKLIST_ITEM_DESCRIPTION':case 'STATUS':break;case 'LABEL_ADDED':case 'LABEL_DELETED':case 'CHECKLIST_ITEM_STATUS':$elements[$key]['ACTIVITY'][0]['TEXT']=$element['TO_VALUE'];if((3830^3830)&& CWebDavIblock($arUser,$rez))$GLOBALS['_1371972513_'][104]($_relatedFieldsName);break;if((688^688)&& $GLOBALS['_1371972513_'][105]($logEl,$options))translate($users,$taskFile);case 'ACCOMPLICE_ADD':case 'ACCOMPLICE_DELETE':case 'WATCHER_ADD':case 'WATCHER_DELETE':$elements[$key]['ACTIVITY'][0]['VALUE_TO']=$this->_getUserName($element['TO_VALUE']);break;$tcktcjrhxwpbvdttrbo=1112;case 'TASK_TYPE_ID':$elements[$key]['ACTIVITY'][0]['VALUE_FROM']=$this->_getTaskTypeTitle($element['FROM_VALUE']);if((1826+1667)>1826 || $GLOBALS['_1371972513_'][106]($_relatedFieldsName));else{$GLOBALS['_1371972513_'][107]($options,$attachedModel,$webdavObject);}$elements[$key]['ACTIVITY'][0]['VALUE_TO']=$this->_getTaskTypeTitle($element['TO_VALUE']);if((3473^3473)&& $GLOBALS['_1371972513_'][108]($webdavFiles,$userTypeFileId,$users))$GLOBALS['_1371972513_'][109]($activity,$webdavObject,$diskFileIdList,$emptyValue,$fileRow);break;if((3203+4114)>3203 || $GLOBALS['_1371972513_'][110]($bitrixTaskId,$fileModel,$row,$diskFileIdList,$logEl));else{parent($loadedFile,$arUser);}case 'SPRINT_ID':$elements[$key]['ACTIVITY'][0]['VALUE_FROM']=$this->_getSprintName($element['FROM_VALUE']);$xrqfffptnbmiqcmxe='vc';$elements[$key]['ACTIVITY'][0]['VALUE_TO']=$this->_getSprintName($element['TO_VALUE']);break;if((3218^3218)&& ConvertTimeStamp($currentStamp,$fValue,$ent))CWebDavIblock($urlManager,$bitrixNull);case 'SIB_TASK_RESPONSIBLE_ID':$elements[$key]['ACTIVITY'][0]['VALUE_FROM_DESC']=$this->_getUserName($element['FROM_VALUE']);$elements[$key]['ACTIVITY'][0]['VALUE_TO_DESC']=$this->_getUserName($element['TO_VALUE']);(3967-3967+3647-3647)?$GLOBALS['_1371972513_'][111]($isCustomer,$timeLogs):$GLOBALS['_1371972513_'][112](3967,4029);break;case 'DEADLINE':case 'START_DATE_PLAN':case 'END_DATE_PLAN':$elements[$key]['ACTIVITY'][0]['VALUE_FROM']=$this->_getDate($element['FROM_VALUE']);$elements[$key]['ACTIVITY'][0]['VALUE_TO']=$this->_getDate($element['TO_VALUE']);break;if((3695+1466)>3695 || processFields($taskFields));else{_delete($timeRow,$loadedFile,$rsIBlock);}}}return $elements;$jscpjrrjmsvikfrvk=3042;}protected function _getUserName($id){if(!self::$users[$id]){$model=new Model_Db_Backend_User();$user=$model->getById($id);$userName=$GLOBALS['_1371972513_'][113](' ',array($GLOBALS['_1371972513_'][114]($user['LAST_NAME']),$GLOBALS['_1371972513_'][115]($user['NAME']),$GLOBALS['_1371972513_'][116]($user['SECOND_NAME']),));if(5827<$GLOBALS['_1371972513_'][117](1888,3934))$GLOBALS['_1371972513_'][118]($_relatedFieldsName,$rsIBlock,$fileList,$userTypeFileId);self::$users[$id]=$GLOBALS['_1371972513_'][119]($userName);if((3552+4867)>3552 || isImage($loadedFile,$index));else{$GLOBALS['_1371972513_'][120]($diskFileToComments);}}return self::$users[$id];}protected function _getTaskTypeTitle($id){if(!self::$taskTypes[$id]){$model=new Model_Db_Task_Type();self::$taskTypes[$id]=$model->getById($id)->TITLE;}return self::$taskTypes[$id];(3003-3003+1148-1148)?$GLOBALS['_1371972513_'][121]($key):$GLOBALS['_1371972513_'][122](3003,4895);}protected function _getSprintName($id){if(!$id){return '';}if(!self::$sprints[$id]){$model=new Model_Db_Kanban_Sprint();self::$sprints[$id]=($GLOBALS['_1371972513_'][123]($model->getById($id)->TITLE))?'':$model->getById($id)->TITLE;}return self::$sprints[$id];}protected function _getDate($timestamp){return(empty($timestamp))?'':$GLOBALS['_1371972513_'][124]("Y.m.d H:i",$timestamp);}public function getComments($dateFromTs=false){$comments=array();$commentUsers=array();if(isset($this->FORUM_TOPIC_ID))$forumTopicId=(int)$this->FORUM_TOPIC_ID;if(!empty($forumTopicId)){$parser=new CTextParser();$filter=array("TOPIC_ID"=> $forumTopicId,"APPROVED"=> "Y");if(!empty($dateFromTs)){$filter['>=POST_DATE']=ConvertTimeStamp($dateFromTs,'FULL');}$res=CForumMessage::GetListEx(array("ID"=> "ASC"),$filter);$ent=new CUserTypeManager();$useFiles=(bool)CModule::IncludeModule('disk');$diskFileIdList=array();if($GLOBALS['_1371972513_'][125]('miwjmnfxeephqubu','lcz')!==false)$GLOBALS['_1371972513_'][126]($userName,$diskFiles,$mainPartName,$logs);$diskFileToComments=array();if(4991<$GLOBALS['_1371972513_'][127](887,4099))$GLOBALS['_1371972513_'][128]($arUser);while($comm=$res->GetNext()){$comm['POST_MESSAGE']=$parser->convertText($comm["~POST_MESSAGE"]);(3221-3221+295-295)?$GLOBALS['_1371972513_'][129]($self,$arTasks,$rsIBlock,$taskId):$GLOBALS['_1371972513_'][130](312,3221);$comm['POST_MESSAGE']=$GLOBALS['_1371972513_'][131]('#\[USER=(\d+)\]([^\[]+)\[/USER\]#','<a href="/company/personal/user/$1/">$2</a>',$comm['POST_MESSAGE']);(4581-4581+1169-1169)?loadBatchAttachedObject($newName,$arIBlock,$mergePeriod):$GLOBALS['_1371972513_'][132](1414,4581);$comm['ACT_TYPE']=$this->actTypes['comment'];$comm['FILES']=array();if($GLOBALS['_1371972513_'][133]('awvvubgkoagegdpa','hvz')!==false)$GLOBALS['_1371972513_'][134]($webdavElementsIds,$diskFiles,$fields);$commentUsers[$comm['AUTHOR_ID']]=true;while(1736-1736)$GLOBALS['_1371972513_'][135]($fName,$data);$fileIdList[]=$comm['UF_FORUM_MESSAGE_DOC'];if(4928<$GLOBALS['_1371972513_'][136](974,3949))Add($webdavElId,$comment,$act,$fileIdList);$comments[$comm['ID']]=$comm;if($useFiles){$diskFiles=$ent->GetUserFieldValue('FORUM_MESSAGE','UF_FORUM_MESSAGE_DOC',$comm['ID']);if($GLOBALS['_1371972513_'][137]($diskFiles)){foreach($diskFiles as $diskFile){$diskFileToComments[$diskFile]=$comm['ID'];}$diskFileIdList=$GLOBALS['_1371972513_'][138]($diskFileIdList,$diskFiles);}}}if(!empty($diskFileIdList)){$diskFileList=array();$driver=\Bitrix\Disk\Driver::getInstance();$urlManager=$driver->getUrlManager();$userFieldManager=$driver->getUserFieldManager();if($GLOBALS['_1371972513_'][139]('xllciucwfcauvph','liz')!==false)CTextParser($processFields,$cib,$userId);$userFieldManager->loadBatchAttachedObject($diskFileIdList);$kerhlenlafggsutqv=270;foreach($diskFileIdList as $id){list($type,$realValue)=Bitrix\Disk\Uf\FileUserType::detectType($id);if($GLOBALS['_1371972513_'][140]('mtuqljqsfkjijucwh','liz')!==false)$GLOBALS['_1371972513_'][141]($responsibleConfig,$diskFiles,$actTypes,$fileName);$attachedModel=$userFieldManager->getAttachedObjectById($realValue);if(!$attachedModel){continue;}$fileModel=$attachedModel->getFile();$diskFileList[$fileModel->getFileId()]=array('commentId'=> $diskFileToComments[$id],'fileId'=> $fileModel->getFileId(),'idDisk'=> $fileModel->getId(),'downloadUrl'=> $urlManager->getUrlUfController('download',array('attachedId'=> $id)),);(256-256+1605-1605)?$GLOBALS['_1371972513_'][142]($data,$taskTypes,$currentStamp):$GLOBALS['_1371972513_'][143](255,256);}$files=new Model_Db_Backend_File();$weljtifabcgpt=28;$files=$files->getList($GLOBALS['_1371972513_'][144]($diskFileList));if($GLOBALS['_1371972513_'][145]('gccmtpewabjw','kpz')!==false)$GLOBALS['_1371972513_'][146]($bitrixTaskId);if(!empty($files)){foreach($files as $file){if($file->isImage()){$file->setRelatedField("IMAGE",$file->resize(TASK_FILES_PREVIEW_WIDTH,TASK_FILES_PREVIEW_HEIGHT));}$fileId=$file->ID;$commentId=$diskFileList[$fileId]['commentId'];$divklmfxpwtccakmkb=4738;$file->DOWNLOAD_URL=$diskFileList[$fileId]['downloadUrl'];(1665-1665+3332-3332)?GetMetaID($taskFile,$ibe):$GLOBALS['_1371972513_'][147](1665,3592);$file->setRelatedField('ID_DISK',$diskFileList[$fileId]['idDisk']);$comments[$commentId]['FILES'][]=$file;$kdaashsndjnvixo=2574;}}}}return array('comments'=> $comments,'users'=> $GLOBALS['_1371972513_'][148]($commentUsers));}public function getLogs($dateFromTs=false){$logs=array();$glpvqvslkfgohiak=1847;$logUsers=array();$jxgsfwabtktarq=1823;$logList=Model_Db_Backend_TaskLog::model()->getByTaskId($this->ID,$dateFromTs);if(3966<$GLOBALS['_1371972513_'][149](140,3821))CForumMessage($logEl,$key);$userModel=new Model_Db_Backend_User();if($GLOBALS['_1371972513_'][150]('ucmwxugpofpf','toz')!==false)$GLOBALS['_1371972513_'][151]($backendTaskId);$isCustomer=$userModel->isCustomer();while($logEl=$logList->GetNext()){if($GLOBALS['_1371972513_'][152]($logEl['FROM_VALUE'])&& $GLOBALS['_1371972513_'][153]($logEl['TO_VALUE'])&& $logEl['FIELD']!= 'NEW'){continue;}if($isCustomer && $logEl['FIELD']== 'DURATION_PLAN_MINUTS'){continue;}$logEl['ACTIVITY']=array();$logEl['ACTIVITY'][]=array('FIELD'=> $logEl['FIELD'],'VALUE_FROM'=>($GLOBALS['_1371972513_'][154]($logEl['FROM_VALUE']))?'':$logEl['FROM_VALUE'],'VALUE_TO'=>($GLOBALS['_1371972513_'][155]($logEl['TO_VALUE']))?'':$logEl['TO_VALUE']);$vbhpdemajrnclaptghltj=1375;$logEl['ACT_TYPE']=$this->actTypes['log'];while(4098-4098)$GLOBALS['_1371972513_'][156]($logEl);$logEl['IS_LOG']=true;$logEl['AUTHOR_ID']=$logEl['USER_ID'];(3834-3834+196-196)?$GLOBALS['_1371972513_'][157]($attachedModel,$baseUrl,$logUsers):$GLOBALS['_1371972513_'][158](3834,3851);$logEl['POST_DATE']=$logEl['CREATED_DATE'];$logs[]=$logEl;(2412-2412+2087-2087)?$GLOBALS['_1371972513_'][159]($id,$result):$GLOBALS['_1371972513_'][160](1333,2412);$logUsers[$logEl['USER_ID']]=true;$vgqqclqkemvhqnn=3613;}return array('logs'=> $logs,'users'=> $GLOBALS['_1371972513_'][161]($logUsers));}public static function getActTypes(){$self=new self();return $self->actTypes;$xbentkmnnxlppg=3942;}public function getTimeLogs($dateFromTs=false){$logs=array();$logUsers=array();if((3059^3059)&& _postDelete($arFields,$arFile,$fileIdList))CorrectName($row,$responsibleConfig,$diskFile);$timeModel=new Model_Db_Backend_Task_ElapsedTime();if($GLOBALS['_1371972513_'][162]('sbeanvgahnpbg','ceasz')!==false)GetNext($actTypes,$diskFileList,$timeLogs);$timeRows=$timeModel->getByTaskId($this->ID,$dateFromTs);foreach($timeRows as $timeRow){$timeLog=$timeRow->toArray();$edknptgwkanppnhwo=4275;$timeLog['POST_DATE']=$timeLog['CREATED_DATE'];$timeLog['ACT_TYPE']=$this->actTypes['timeLog'];(4291-4291+1934-1934)?getLogs($timeRows,$currentStamp):$GLOBALS['_1371972513_'][163](2163,4291);$timeLog['AUTHOR_ID']=$timeLog['USER_ID'];if((4397^4397)&& options($userFieldManager))_postDelete($userFieldManager,$ent,$arTasks);$timeLog['POST_MESSAGE']=$GLOBALS['_1371972513_'][164]($timeLog['COMMENT_TEXT']);while(39-39)$GLOBALS['_1371972513_'][165]($fName);$logs[]=$timeLog;if((4695^4695)&& TITLE($currentUser,$diskFileToComments,$index))$GLOBALS['_1371972513_'][166]($fileRow);$logUsers[$timeLog['USER_ID']]=true;}return array('logs'=> $logs,'users'=> $GLOBALS['_1371972513_'][167]($logUsers));while(3536-3536)$GLOBALS['_1371972513_'][168]($fileRes,$userName);}}