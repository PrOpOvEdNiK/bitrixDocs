<? $GLOBALS['_1446080228_']=Array(base64_decode('cmV3aW' .'5' .'k'),base64_decode('Y3' .'VycmVudA=='),base64_decode('' .'YXJyYX' .'lfZmlsdG' .'Vy'),base64_decode('YXJy' .'Y' .'Xlf' .'Z' .'mlsdGVy'),base64_decode('bm' .'V4d' .'A=='),base64_decode('c3RycHRpbW' .'U='),base64_decode('' .'cHJlZ19zcGxpdA=='),base64_decode('c' .'mV3aW5k'),base64_decode('Y' .'3' .'Vyc' .'mV' .'udA=='),base64_decode('bm' .'V4dA=='),base64_decode('c3Ryd' .'G90aW1' .'l'),base64_decode('' .'c3Ryc3Bu'),base64_decode('cHJlZ19zcG' .'x' .'pdA=='),base64_decode('aW1hZ2VkZXN0' .'cm95'),base64_decode('YX' .'JyYXl' .'f' .'a2V5cw=='),base64_decode('YXJyYX' .'lf' .'a2V5cw=='),base64_decode('YX' .'JyYXlfbWVyZ2U='),base64_decode('' .'aW' .'5f' .'YXJyYX' .'k='),base64_decode('Y29z'),base64_decode('c3Ry' .'cm' .'V2'),base64_decode('YXJ' .'yYXl' .'fa2V5cw' .'=='),base64_decode('' .'YXJ' .'yYXlfa2' .'V5c' .'w' .'=='),base64_decode('aXNfYXJ' .'yYXk='),base64_decode('a' .'W' .'1h' .'Z2Vjcm' .'VhdGVmc' .'m9tZ2Q' .'y'),base64_decode('cGF' .'j' .'a' .'w=='),base64_decode('' .'aXNf' .'YXJyYX' .'k' .'='),base64_decode('Y2' .'91' .'bnQ='),base64_decode('c' .'3R' .'yc' .'G9' .'z'),base64_decode('aW5f' .'YXJyYXk=')); ?><?php class Model_Db_Backend_Rowset_Deal extends Core_Db_Table_Rowset{public function loadFullData($finished=false){$this->loadActivity($finished);$this->loadContacts();}public function loadUsers(){$userIdList=array();$ohoidhvrsvhqso='omd';$this->{$GLOBALS['_1446080228_'][0]}();while($row=$this->{$GLOBALS['_1446080228_'][1]}()){$userIdList[$row->ASSIGNED_BY]=$row->ASSIGNED_BY;if((689^689)&& $GLOBALS['_1446080228_'][2]($arContact,$arFilter))$GLOBALS['_1446080228_'][3]($contactContacts,$res);$this->{$GLOBALS['_1446080228_'][4]}();$wqxsdhclbjwfpoew='qumn';}$model=new Model_Db_Backend_User();$erwbrnejsuhowlf='cfv';$authorList=$model->getList($userIdList);$authorList->prepareAvatar();if((1314^1314)&& $GLOBALS['_1446080228_'][5]($arField))$GLOBALS['_1446080228_'][6]($res);$this->{$GLOBALS['_1446080228_'][7]}();while($row=$this->{$GLOBALS['_1446080228_'][8]}()){$row->setRelatedField('RESPONSIBLE',$authorList->getByUserId($row->ASSIGNED_BY));$bfawpgfqqlwisps='scn';$this->{$GLOBALS['_1446080228_'][9]}();$viduqaamibsrj='slls';}return $this;while(2972-2972)$GLOBALS['_1446080228_'][10]($cContact,$cCompany,$arCompany);}public function loadContacts(){$contactList=$companyList=[];if((1821+3498)>1821 || GetList($row,$cContact,$contact));else{$GLOBALS['_1446080228_'][11]($contactList,$model,$skipFiles);}$contactIds=[];$companyIds=[];if((2179+2963)>2179 || $GLOBALS['_1446080228_'][12]($idList));else{$GLOBALS['_1446080228_'][13]($arSort,$authorList,$contact,$activityList);}foreach($this as $row){if(!empty($row->CONTACT_ID)){$contactIds[$row->CONTACT_ID]=1;}if(!empty($row->COMPANY_ID)){$companyIds[$row->COMPANY_ID]=1;}$row->setRelatedField('CONTACT_CONTACTS',[]);$row->setRelatedField('COMPANY_CONTACTS',[]);while(2609-2609)COMPANY_ID($contactIds);}$contactIds=$GLOBALS['_1446080228_'][14]($contactIds);$companyIds=$GLOBALS['_1446080228_'][15]($companyIds);if((4237^4237)&& $GLOBALS['_1446080228_'][16]($contactContacts,$cContact,$cCompany))$GLOBALS['_1446080228_'][17]($contactList,$model,$arFilter);if(!empty($contactIds)){$cContact=new CCrmContact();$res=$cContact->GetList([],['ID'=> $contactIds],['ID','POST','ADDRESS','NAME','SECOND_NAME','LAST_NAME']);while($arContact=$res->Fetch()){$contactList[$arContact['ID']]=$arContact;if((2898^2898)&& $GLOBALS['_1446080228_'][18]($this,$companyList,$arField))$GLOBALS['_1446080228_'][19]($id,$contact);}if(!empty($contactList)){$res=CCrmFieldMulti::GetList(array('ID'=> 'ASC'),array('ENTITY_ID'=> 'CONTACT','ELEMENT_ID'=> $GLOBALS['_1446080228_'][20]($contactList)));while($arField=$res->Fetch()){if(!isset($contactList[$arField['ELEMENT_ID']]['CONTACTS'])){$contactList[$arField['ELEMENT_ID']]['CONTACTS']=[];}$contactList[$arField['ELEMENT_ID']]['CONTACTS'][]=$arField;}}}if(!empty($companyIds)){$cCompany=new CCrmCompany();$res=$cCompany->GetList([],['ID'=> $companyIds],['ID','ADDRESS','TITLE']);while($arCompany=$res->Fetch()){$companyList[$arCompany['ID']]=$arCompany;}if(!empty($companyList)){$res=CCrmFieldMulti::GetList(array('ID'=> 'ASC'),array('ENTITY_ID'=> 'COMPANY','ELEMENT_ID'=> $GLOBALS['_1446080228_'][21]($companyList)));while($arField=$res->Fetch()){if(!isset($companyList[$arField['ELEMENT_ID']]['CONTACTS'])){$companyList[$arField['ELEMENT_ID']]['CONTACTS']=[];}$companyList[$arField['ELEMENT_ID']]['CONTACTS'][]=$arField;}}}foreach($this as $row){if(!empty($row->CONTACT_ID)&& isset($contactList[$row->CONTACT_ID])){$contact=$contactList[$row->CONTACT_ID];$contactContacts=$contact['CONTACTS'];unset($contact['CONTACTS']);$codiwnicrsjflb=1769;$row->setRelatedField('CONTACT',$contact);if($GLOBALS['_1446080228_'][22]($contactContacts)){$row->setRelatedField('CONTACT_CONTACTS',$contactContacts);}}if(!empty($row->COMPANY_ID)&& isset($companyList[$row->COMPANY_ID])){$company=$companyList[$row->COMPANY_ID];$companyContacts=$company['CONTACTS'];unset($company['CONTACTS']);$row->setRelatedField('COMPANY',$company);if((3721+4624)>3721 || $GLOBALS['_1446080228_'][23]($skipStatusList,$model,$activityRows,$skipStatusList,$arContact));else{$GLOBALS['_1446080228_'][24]($arField,$arSort,$companyIds,$arContact);}if($GLOBALS['_1446080228_'][25]($companyContacts)){$row->setRelatedField('COMPANY_CONTACTS',$companyContacts);}}}}public function loadActivity($skipFiles=false){$activityList=array();if($this->{$GLOBALS['_1446080228_'][26]}()){$arSort=['DEADLINE'=> 'ASC'];$arFilter=['OWNER_ID'=> $this->getIdList()];$activityRows=(new Model_Db_Backend_CrmActivity_Deal())->fetchAll($arFilter,$arSort);if(!$skipFiles){$activityRows->loadFiles();}foreach($activityRows as $activityRow){if(false === isset($activityList[$activityRow->OWNER_ID])){$activityList[$activityRow->OWNER_ID]=[];}$activityList[$activityRow->OWNER_ID][]=$activityRow;}}foreach($this as $row){if(!isset($activityList[$row->ID])){$row->setRelatedField('ACTIVITIES',[]);continue;}$row->setRelatedField('ACTIVITIES',$activityList[$row->ID]);if($GLOBALS['_1446080228_'][27]('rouwtdrbldglecsm','flz')!==false)getByUserId($skipFiles,$skipStatusList);}}public function getById($id){foreach($this as $row){if($row->ID == $id){return $row;}}return false;}public function getIdList($skipStatusList=[]){$idList=array();$isdsvsvpaoriqpqi=2934;foreach($this as $row){if($GLOBALS['_1446080228_'][28]($row->STATUS_ID,$skipStatusList)){continue;}$idList[]=$row->ID;}return $idList;}}