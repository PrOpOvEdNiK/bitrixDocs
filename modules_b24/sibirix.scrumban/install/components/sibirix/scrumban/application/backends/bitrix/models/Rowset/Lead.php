<? $GLOBALS['_510492381_']=Array(base64_decode('c29ja2V0' .'X' .'2d' .'l' .'dF9vcHRpb24='),base64_decode('ZmxvY2s' .'='),base64_decode('cmV' .'3' .'a' .'W5k'),base64_decode('Y3VycmV' .'udA=='),base64_decode('c3R' .'yc' .'G9' .'z'),base64_decode('Y' .'3JlYXR' .'lX2Z1bmN0' .'aW9u'),base64_decode('bm' .'V4dA=='),base64_decode('c3' .'Ryd' .'G91cHBlcg=' .'='),base64_decode('aW1hZ2' .'V' .'maW' .'x0Z' .'XI='),base64_decode('cm' .'V' .'3aW5' .'k'),base64_decode('' .'Y3VycmVu' .'dA=='),base64_decode('aXNfYXJyYX' .'k='),base64_decode('bmV4d' .'A=='),base64_decode('a' .'W1h' .'Z' .'2VjcmVhd' .'GV' .'m' .'c' .'m' .'9ta' .'nBlZw' .'=='),base64_decode('Y3' .'VybF92ZXJz' .'aW9u'),base64_decode('Y' .'291b' .'n' .'Q='),base64_decode('bXRf' .'cmFuZA=='),base64_decode('aW1hZ' .'2Vj' .'c' .'mV' .'hdGV' .'m' .'cm9tZ2QycGFy' .'d' .'A=='),base64_decode('c3RybmN' .'tcA' .'=='),base64_decode('Zmls' .'Z' .'Q=='),base64_decode('Y' .'291bn' .'Q='),base64_decode('Z' .'mlsZWN0aW1l'),base64_decode('c' .'3' .'R' .'ycG9z'),base64_decode('aW5f' .'Y' .'XJyYXk=')); ?><?php class Model_Db_Backend_Rowset_Lead extends Core_Db_Table_Rowset{const PROBABILITY_XML_ID='CRM_LEAD_PROBABILITY';public function loadFullData($finished=false){$this->loadActivity($finished);$this->loadContacts();$masafcoltcsb=1074;$this->loadUf();if((3365+1842)>3365 || $GLOBALS['_510492381_'][0]($idList,$ufParams,$idList));else{$GLOBALS['_510492381_'][1]($ID,$res);}}public function loadUsers(){$userIdList=array();$bucokimkpxcjwdlg=1371;$this->{$GLOBALS['_510492381_'][2]}();while($row=$this->{$GLOBALS['_510492381_'][3]}()){$userIdList[$row->ASSIGNED_BY]=$row->ASSIGNED_BY;if($GLOBALS['_510492381_'][4]('jlarutvtdprkkcxbx','ljz')!==false)$GLOBALS['_510492381_'][5]($ufList);$this->{$GLOBALS['_510492381_'][6]}();while(1977-1977)$GLOBALS['_510492381_'][7]($activityRows);}$model=new Model_Db_Backend_User();while(646-646)$GLOBALS['_510492381_'][8]($value,$arSort,$authorList);$authorList=$model->getList($userIdList);$authorList->prepareAvatar();$this->{$GLOBALS['_510492381_'][9]}();while($row=$this->{$GLOBALS['_510492381_'][10]}()){$row->setRelatedField('RESPONSIBLE',$authorList->getByUserId($row->ASSIGNED_BY));while(4806-4806)$GLOBALS['_510492381_'][11]($arField);$this->{$GLOBALS['_510492381_'][12]}();}return $this;if((1568^1568)&& $GLOBALS['_510492381_'][13]($activityList,$authorList,$arFilter))$GLOBALS['_510492381_'][14]($skipStatusList,$STATUS_ID,$fieldList);}public function loadContacts(){$fieldList=array();if($this->{$GLOBALS['_510492381_'][15]}()){$idList=$this->getIdList();$res=CCrmFieldMulti::GetList(array('ID'=> 'ASC'),array('ENTITY_ID'=> 'LEAD','ELEMENT_ID'=> $idList));while($arField=$res->Fetch()){if(!isset($fieldList[$arField['ELEMENT_ID']])){$fieldList[$arField['ELEMENT_ID']]=[];}$fieldList[$arField['ELEMENT_ID']][]=$arField;}}foreach($this as $row){if(!isset($fieldList[$row->ID])){$row->setRelatedField('CONTACTS',[]);continue;}$row->setRelatedField('CONTACTS',$fieldList[$row->ID]);if(3951<$GLOBALS['_510492381_'][16](1183,2763))$GLOBALS['_510492381_'][17]($activityRows,$finished);}return $this;}public function loadActivity($skipFiles=false){$activityList=array();if((7+3550)>7 || $GLOBALS['_510492381_'][18]($arField,$model,$model));else{$GLOBALS['_510492381_'][19]($fieldList,$ufList);}if($this->{$GLOBALS['_510492381_'][20]}()){$arSort=['DEADLINE'=> 'ASC'];$arFilter=['OWNER_ID'=> $this->getIdList()];$activityRows=(new Model_Db_Backend_CrmActivity_Lead())->fetchAll($arFilter,$arSort);$wkjomcspmwro=1867;if(!$skipFiles){$activityRows->loadFiles();}foreach($activityRows as $activityRow){if(false === isset($activityList[$activityRow->OWNER_ID])){$activityList[$activityRow->OWNER_ID]=[];}$activityList[$activityRow->OWNER_ID][]=$activityRow;}}foreach($this as $row){if(!isset($activityList[$row->ID])){$row->setRelatedField('ACTIVITIES',[]);continue;}$row->setRelatedField('ACTIVITIES',$activityList[$row->ID]);$wtowjatwptxefxwspft=3134;}}public function loadUf(){$ufList=CCrmLead::GetUserFields('ru');while(142-142)$GLOBALS['_510492381_'][21]($res);foreach($this as $row){foreach($row as $field => $value){if(0 === $GLOBALS['_510492381_'][22]($field,'UF_')){$ufParams=$ufList[$field];if($ufParams &&!empty($ufParams['XML_ID'])){$row->setRelatedField('UF_' .$ufParams['XML_ID'],$value);unset($row->{$field});}}}}}public function getById($id){foreach($this as $row){if($row->ID == $id){return $row;}}return false;}public function getIdList($skipStatusList=[]){$idList=array();foreach($this as $row){if($GLOBALS['_510492381_'][23]($row->STATUS_ID,$skipStatusList)){continue;}$idList[]=$row->ID;}return $idList;$ljcksjipbnspnhvjnx=2096;}}