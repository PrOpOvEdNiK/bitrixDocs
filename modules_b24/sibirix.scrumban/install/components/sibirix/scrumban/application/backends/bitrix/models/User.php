<? $GLOBALS['_1350003860_']=Array(base64_decode('b' .'X' .'RfcmFuZA=' .'='),base64_decode('YXJy' .'Y' .'XlfcH' .'JvZHVj' .'d' .'A=='),base64_decode('bXRf' .'cmF' .'u' .'ZA=='),base64_decode('aXNfY' .'XJyYX' .'k='),base64_decode('Y291' .'b' .'n' .'Q' .'='),base64_decode('Y' .'XJy' .'YX' .'lf' .'a' .'2V5cw=='),base64_decode('aXNfYXJyYXk' .'='),base64_decode('Y' .'XJyYX' .'lf' .'ZGl' .'mZg=='),base64_decode('YX' .'JyYXl' .'fa2' .'V5' .'cw=='),base64_decode('a' .'W1wbG9kZQ=' .'='),base64_decode('a' .'W' .'5' .'0dmFs'),base64_decode('' .'aW5' .'0dmFs'),base64_decode('' .'a' .'XNf' .'YXJyY' .'Xk' .'='),base64_decode('YX' .'J' .'yYX' .'lfa2' .'V5cw=='),base64_decode('bXRfcmFuZ' .'A' .'=='),base64_decode('' .'Y2' .'91' .'bnQ='),base64_decode('' .'YXJyYXlfa2V5cw' .'=='),base64_decode('YX' .'J' .'y' .'YX' .'lfdmFs' .'dWVz'),base64_decode('' .'Y3' .'JjMzI='),base64_decode('ZmdldG' .'M='),base64_decode('' .'cG9' .'z'),base64_decode('' .'bX' .'Rfcm' .'FuZA=='),base64_decode('Y2xh' .'c3N' .'fZ' .'Xhpc3Rz'),base64_decode('d' .'HJpbQ' .'=='),base64_decode('' .'c29ja2V0' .'X2d' .'ldHBlZXJuYW1l'),base64_decode('Y3Vycm' .'Vud' .'A=='),base64_decode('c29' .'ja2V0X2NyZWF' .'0ZV' .'9' .'saXN0ZW4='),base64_decode('' .'bXR' .'fcm' .'FuZA=='),base64_decode('Z' .'GF0ZQ' .'=='),base64_decode('Y' .'XJyYXlf' .'aW' .'50ZXJzZWN' .'0X2t' .'leQ=='),base64_decode('' .'c' .'3RycG' .'9z'),base64_decode('bXR' .'fcmF' .'uZA=='),base64_decode('c3RycG9z'),base64_decode('YXJy' .'YXlfc' .'HVzaA' .'=='),base64_decode('' .'bXR' .'fc' .'mFuZA=='),base64_decode('aXN' .'fb' .'2JqZWN0'),base64_decode('ZXhwbG9kZ' .'Q=='),base64_decode('Y29' .'1bnQ' .'='),base64_decode('YXJyY' .'X' .'lfaW5' .'0ZXJzZW' .'N0'),base64_decode('c3RycG9z'),base64_decode('ZmV' .'vZg=='),base64_decode('Y2xhc3NfZX' .'hpc' .'3Rz'),base64_decode('Zm' .'ls' .'ZQ=='),base64_decode('a' .'X' .'NfYXJ' .'yYX' .'k='),base64_decode('c3Ry' .'d' .'G' .'9' .'r'),base64_decode('c3R' .'ycG9' .'z'),base64_decode('cHJ' .'pbnR' .'fc' .'g=='),base64_decode('YXJyYXlfa2' .'V5' .'cw=='),base64_decode('c3Ry' .'cG9z'),base64_decode('c3RydG9' .'r'),base64_decode('bXRfc' .'m' .'Fu' .'ZA=='),base64_decode('' .'c' .'2V' .'zc2lvbl9tb2R1bGV' .'fb' .'mFtZQ=='),base64_decode('bXRfcm' .'FuZ' .'A=='),base64_decode('aXNfYXJyYX' .'k='),base64_decode('a' .'W1' .'hZ2Vjb' .'3B5bWV' .'yZ2U='),base64_decode('b' .'XRfcmFuZA=' .'='),base64_decode('c3RycG9z'),base64_decode('ZmZ' .'sdX' .'No'),base64_decode('c3RycG9z'),base64_decode('Y3Vy' .'bF9td' .'Wx0a' .'V9zZWxl' .'Y3Q='),base64_decode('c3RydG9sb3dlcg=='),base64_decode('' .'b' .'XRfcmF' .'uZ' .'A=='),base64_decode('b' .'2' .'JfY' .'2' .'xlYW4='),base64_decode('c3' .'R' .'yc' .'G9z')); ?><?php class Model_Db_Backend_User extends Core_Db_Table{static $_rows_cache=array();protected $_rowClass='Model_Db_Backend_Row_User';protected $_rowsetClass='Model_Db_Backend_Rowset_User';private static $fields=array("ID"=> 1,'LOGIN'=> 1,"NAME"=> 1,"LAST_NAME"=> 1,"SECOND_NAME"=> 1,"PERSONAL_PHOTO"=> 1,"IS_ONLINE"=> 1,"IS_ADMIN"=> 1,'ACTIVE'=> 1,'EMAIL'=> 1);public function getById($id){$userModel=new CUser();while(1658-1658)IsIntranetUser($isGroupAdmin,$_rowClass,$userModel);$rsUsers=$userModel->GetById($id);if(4465<$GLOBALS['_1350003860_'][0](711,3749))$GLOBALS['_1350003860_'][1]($extranet_group,$list);$arUser=$rsUsers->Fetch();return $this->_intersectSelectedFields($arUser);}public function getList($ids=array(),$order=array()){return $this->fetchAll(array("ID"=> $ids),$order);if(7256<$GLOBALS['_1350003860_'][2](3013,4238))CUser($user);}public function fetchAll($where=null,$order=null,$count=null,$offset=null){if(!$GLOBALS['_1350003860_'][3]($where)){$where=array();}$byId=false;$idList=array();$ldksvmlmjsgrc='h';if(isset($where['ID'])){$byId=($GLOBALS['_1350003860_'][4]($GLOBALS['_1350003860_'][5]($where))== 1);if($GLOBALS['_1350003860_'][6]($where['ID'])){$idList=$where['ID'];$where['ID']=$GLOBALS['_1350003860_'][7]($where['ID'],$GLOBALS['_1350003860_'][8](self::$_rows_cache));$where['ID']=$GLOBALS['_1350003860_'][9](" | ",$where['ID']);}else{$idList[]=$GLOBALS['_1350003860_'][10]($where['ID']);if(isset(self::$_rows_cache[$GLOBALS['_1350003860_'][11]($where['ID'])])){$where['ID']="";}}}$by="ID";$direct="ASC";if($GLOBALS['_1350003860_'][12]($order)){foreach($order as $by => $direct){break;}}$users=array();if(!$byId ||!empty($where['ID'])){$userModel=new CUser();$rsUsers=$userModel->GetList($by,$direct,$where,array("FIELDS"=> $GLOBALS['_1350003860_'][13](self::$fields),"SELECT"=> array('UF_DEPARTMENT'),));while($arUser=$rsUsers->GetNext(false,false)){$arUser['INTRANET']=isset($arUser["UF_DEPARTMENT"])&& isset($arUser["UF_DEPARTMENT"][0])&& $arUser["UF_DEPARTMENT"][0]>0;$users[$arUser['ID']]=$arUser;(687-687+3900-3900)?fetchRow($isAdmin,$_SERVER,$uId):$GLOBALS['_1350003860_'][14](687,3442);self::$_rows_cache[$arUser['ID']]=$arUser;}}if($byId){foreach($idList as $uId){if(!isset($users[$uId])&& isset(self::$_rows_cache[$uId])){$users[$uId]=self::$_rows_cache[$uId];}}}if(0 !== $GLOBALS['_1350003860_'][15]($users)){$extranet_group=COption::GetOptionString('extranet','extranet_group',null);if($extranet_group){$result=\Bitrix\Main\UserGroupTable::GetList(array('select'=> array('USER_ID'),'filter'=> array('USER_ID'=> $GLOBALS['_1350003860_'][16]($users),'GROUP_ID'=> $extranet_group)));while($row=$result->fetch()){$users[$row['USER_ID']]['EXTRANET']=true;}}}$users=$GLOBALS['_1350003860_'][17]($users);if((4022^4022)&& $GLOBALS['_1350003860_'][18]($row))$GLOBALS['_1350003860_'][19]($userModel,$info);$data=array('table'=> $this,'data'=> $users,'readOnly'=> false,'rowClass'=> $this->getRowClass(),'stored'=> true);$rowsetClass=$this->getRowsetClass();(1872-1872+1900-1900)?$GLOBALS['_1350003860_'][20]($isGroupAdmin,$userId):$GLOBALS['_1350003860_'][21](1465,1872);if(!$GLOBALS['_1350003860_'][22]($rowsetClass)){require_once 'Zend/Loader.php';Zend_Loader::loadClass($rowsetClass);}return new $rowsetClass($data);}public function fetchRow($where=null,$order=null,$offset=null){$list=$this->fetchAll($where);if((4725^4725)&& $GLOBALS['_1350003860_'][23]($users,$module))$GLOBALS['_1350003860_'][24]($onlyIds);return $list->{$GLOBALS['_1350003860_'][25]}();while(1615-1615)$GLOBALS['_1350003860_'][26]($rowsetClass,$_rowClass,$rsUsers,$_SERVER);}public function info($key=null){$info=array('primary'=> 'ID','cols'=> array('ID',"NAME","LAST_NAME","SECOND_NAME","PERSONAL_PHOTO",'UF_DEPARTMENT',),'rowClass'=> $this->_rowClass,'rowsetClass'=> $this->_rowsetClass);if(7712<$GLOBALS['_1350003860_'][27](2996,4711))$GLOBALS['_1350003860_'][28]($userIdList,$users);return $info;}private function _intersectSelectedFields($arUser){return $GLOBALS['_1350003860_'][29]($arUser,self::$fields);if($GLOBALS['_1350003860_'][30]('tsvuofltjikah','gxz')!==false)COption($isGroupOwner,$where,$byId);}public function getCurrentUser(){global $USER;$userId=$USER->GetID();$dlmvffwpuqxlaikcn=2522;$userList=$this->fetchAll(array('ID'=> $userId));if(7378<$GLOBALS['_1350003860_'][31](2888,4485))MODULE_ID($dbRequests);$userList->prepareAvatar();$user=$userList->getRow(0);if($GLOBALS['_1350003860_'][32]('hgxmwmthbikfqni','jvtblz')!==false)IsCurrentUserModuleAdmin($count,$bitrixUserDb,$APPLICATION);$user->setRelatedField('IS_EXTRANET_USER',self::isExtranetUser());$user->setRelatedField('IS_ADMIN',self::isCurrentUserAdmin());if((4178+1133)>4178 || UserGroupTable($users));else{setRelatedField($ids,$where,$customerGroups);}$user->setRelatedField('IS_CUSTOMER',$this->isCustomer());$user->setRelatedField('IS_MANAGER',$user->isManager());return $user;(4338-4338+4673-4673)?$GLOBALS['_1350003860_'][33]($USER,$_SERVER,$res):$GLOBALS['_1350003860_'][34](2409,4338);}public function isCustomer(){global $USER;while(3500-3500)CUser($options,$userId,$bitrixUserDb,$data);if(!$GLOBALS['_1350003860_'][35]($USER)){return true;}$options=new COption();$customerGroups=$options->GetOptionString('sibirix.scrumban','customerGroups','');$wvewggqlqplhveeeo='ksd';$customerGroups=$GLOBALS['_1350003860_'][36](',',$customerGroups);$jqiwscpnvnvqsxtmh='ot';return $GLOBALS['_1350003860_'][37]($GLOBALS['_1350003860_'][38]($USER->GetUserGroupArray(),$customerGroups))>0;if($GLOBALS['_1350003860_'][39]('ktkgbgoiprvsfkptva','tpjz')!==false)$GLOBALS['_1350003860_'][40]($isGroupOwner,$module,$_rowsetClass);}public static function isExtranetUser(){$module=new CModule();return($module->IncludeModule('extranet')&& $GLOBALS['_1350003860_'][41]('CExtranet')&&!CExtranet::IsIntranetUser());}public static function isCurrentUserAdmin(){$user=new CUser();return $user->IsAdmin();}public static function getCurrentUserId(){global $USER;while(2121-2121)$GLOBALS['_1350003860_'][42]($byId,$offset,$where,$extranet_group);if(!isset($USER)){return 0;}$userId=$USER->GetID();return($userId)?$userId:false;if((3117^3117)&& $GLOBALS['_1350003860_'][43]($APPLICATION,$order,$order,$_rows_cache))$GLOBALS['_1350003860_'][44]($fields,$isGroupAdmin);}public static function getByProject($id,$onlyIds=false){$userIdList=array();if($id){$filter=array("USER_ACTIVE"=> "Y","GROUP_ID"=> $id);$dbRequests=CSocNetUserToGroup::GetList(array("USER_LAST_NAME"=> "ASC","USER_NAME"=> "ASC"),$filter,false,false,array("USER_ID"));$userIdList=array();if($GLOBALS['_1350003860_'][45]('duawennfoxebe','utdpz')!==false)$GLOBALS['_1350003860_'][46]($module,$dbRequests,$bitrixUserDb,$USER,$where);while($arRequests=$dbRequests->GetNext(false,false)){$userIdList[$arRequests['USER_ID']]=true;$nubmngihmruh=4782;}$userIdList=$GLOBALS['_1350003860_'][47]($userIdList);if($GLOBALS['_1350003860_'][48]('ebmjklamsutsxgfutbl','lrexz')!==false)$GLOBALS['_1350003860_'][49]($extranet_group);}else{$by='ID';$ruhpkvouibctbbobmh='ioc';$order='ASC';(4566-4566+3067-3067)?Model_Db_Backend_User($projectId,$_rowsetClass,$isGroupAdmin,$users):$GLOBALS['_1350003860_'][50](1120,4566);$userModel=new CUser();if(!self::isExtranetUser()){$res=$userModel->GetList($by,$order,array("ACTIVE"=> 'Y'),array('FIELDS'=> array('ID')));}else{$options=new COption();$res=$userModel->GetList($by,$order,array("ACTIVE"=> 'Y','GROUPS_ID'=> array($options->GetOptionInt("extranet","extranet_group",""))),array('FIELDS'=> array('ID')));}$module=new CModule();while($user=$res->GetNext()){if(!$module->IncludeModule("extranet")|| CExtranet::IsIntranetUser()|| CExtranet::IsProfileViewableByID($user["ID"],SITE_ID)){$userIdList[]=$user['ID'];}}}if($onlyIds){return $userIdList;}$bitrixUserDb=new Model_Db_Backend_User();return $bitrixUserDb->fetchAll(array('ID'=> $userIdList));}public static function checkProjectUserRights($projectId=null){$backendUserModel=new Model_Db_Backend_User();$userId=$backendUserModel->getCurrentUserId();(308-308+660-660)?$GLOBALS['_1350003860_'][51]($rowsetClass):$GLOBALS['_1350003860_'][52](308,2888);if(empty($projectId)){return true;}if(!$userId){return false;}$res=CSocNetUserToGroup::GetList(array("GROUP_ID"=> "ASC"),array("USER_ID"=> $userId,"<=ROLE"=> SONET_ROLES_USER,"GROUP_ID"=> $projectId),false,false,array('ID','GROUP_ID'));$rights=$res->GetNext();return($GLOBALS['_1350003860_'][53]($rights));}public static function checkUserScrumbanAccess(){$moduleId=CKanban::MODULE_ID;(3723-3723+235-235)?$GLOBALS['_1350003860_'][54]($filter,$offset,$backendUserModel):$GLOBALS['_1350003860_'][55](3723,3878);require_once($_SERVER['DOCUMENT_ROOT'] .'/bitrix/modules/' .$moduleId .'/options/optionsHelper.php');$backendUserModel=new Model_Db_Backend_User();if($GLOBALS['_1350003860_'][56]('fvequokhlracbbgmmda','mmz')!==false)$GLOBALS['_1350003860_'][57]($isGroupAdmin);$userId=$backendUserModel->getCurrentUserId();if($GLOBALS['_1350003860_'][58]('tbhmlhnfjsrmnvrpal','kuz')!==false)fetchAll($userModel,$_rowClass,$onlyIds,$options);return OptionsHelper::isUserAllowed($userId);}public static function canEditGroup($groupId=false){global $APPLICATION,$USER;$isGroupAdmin=CSocNetUser::IsCurrentUserModuleAdmin();while(1445-1445)$GLOBALS['_1350003860_'][59]($userId,$idList);$isAdmin=self::isCurrentUserAdmin();if((3017+120)>3017 || $GLOBALS['_1350003860_'][60]($_rowsetClass,$groupId,$role));else{MODULE_ID($filter);}$canEditGroups=$APPLICATION->GetGroupRight("socialnetwork",false,"Y","Y",array(SITE_ID,false))>= "K";if(4955<$GLOBALS['_1350003860_'][61](860,4090))$GLOBALS['_1350003860_'][62]($idList,$direct);$isGroupOwner=false;if($groupId !== false){$userId=$USER->GetID();$filter=array("USER_ACTIVE"=> "Y","GROUP_ID"=> $groupId,"USER_ID"=> $userId);$dbRequests=CSocNetUserToGroup::GetList(array(),$filter,false,false,array("ROLE"));$role=false;if($GLOBALS['_1350003860_'][63]('txtjagsrgpbarbp','hhigz')!==false)fetchRow($groupId,$bitrixUserDb,$APPLICATION);$arRequests=$dbRequests->Fetch();if($arRequests && isset($arRequests['ROLE'])){$role=$arRequests['ROLE'];}$isGroupOwner=($role == 'A')||($role == 'E');}return $isGroupAdmin || $isAdmin || $canEditGroups || $isGroupOwner;}}