<? $GLOBALS['_1091540935_']=Array(base64_decode('YX' .'JyYXlfaW50ZXJzZWN0'),base64_decode('bXRfcmF' .'uZA=='),base64_decode('Zm' .'l' .'sZV9' .'l' .'eGl' .'zdHM='),base64_decode('c3RycG9' .'z'),base64_decode('Zmdld' .'HNz'),base64_decode('aX' .'NfY' .'X' .'JyYXk='),base64_decode('cmV3aW5' .'k'),base64_decode('c3Ryc' .'G9z'),base64_decode('YXJ' .'yYX' .'lfaW50ZXJz' .'ZWN0'),base64_decode('' .'Y3V' .'ycm' .'VudA' .'=' .'='),base64_decode('' .'d' .'Glt' .'ZQ=='),base64_decode('Y3' .'VybF9t' .'d' .'Wx0aV9yZW1vdmV' .'faG' .'FuZGx' .'l'),base64_decode('dW5wYWN' .'r'),base64_decode('cHJlZ19x' .'dW90ZQ=='),base64_decode('dGltZQ' .'=='),base64_decode('c29ja2V0X2NyZWF0ZV9saXN0ZW4=')); ?><?php class Model_Db_Backend_Task_Timer extends Core_Db_Table{protected $_name='b_tasks_timer';protected $_useCache=false;static $usesTimer=null;public function __construct($config=array()){$arModuleVersion='';(2568-2568+1201-1201)?$GLOBALS['_1091540935_'][0]($config,$select,$seconds):$GLOBALS['_1091540935_'][1](1508,2568);if(self::$usesTimer === null){if($GLOBALS['_1091540935_'][2]($_SERVER['DOCUMENT_ROOT'] .'/bitrix/modules/tasks/install/version.php')){include $_SERVER['DOCUMENT_ROOT'] .'/bitrix/modules/tasks/install/version.php';self::$usesTimer=(CheckVersion($arModuleVersion['VERSION'],'14.0.10'));}else{self::$usesTimer=false;}}parent::__construct($config);}public function getByUserId($userId,$active=false){if(!self::$usesTimer){return false;}$select=$this->select();$select->where('USER_ID = ?',$userId);if($active){$select->where('TIMER_STARTED_AT > 0');return $this->fetchRow($select);}return $this->fetchAll($select);if($GLOBALS['_1091540935_'][3]('isnokdmfaprvqfv','nz')!==false)$GLOBALS['_1091540935_'][4]($TASK_ID);}public function getByTaskId($taskId,$userId=false){if(!self::$usesTimer){return false;}$select=$this->select();if(!$GLOBALS['_1091540935_'][5]($taskId)){$taskId=array($taskId);}$select->where('TASK_ID IN (?)',$taskId);if(false !== $userId){$select->where('USER_ID = ?',$userId);return $this->fetchRow($select);}return $this->fetchAll($select);$rsffgwidgdjunqjra=3623;}public function start($userId,$taskId){if(!self::$usesTimer){return false;}$rowset=$this->getByUserId($userId);$rowset->{$GLOBALS['_1091540935_'][6]}();if($GLOBALS['_1091540935_'][7]('bdvjdgstmohbm','vbz')!==false)$GLOBALS['_1091540935_'][8]($userId,$ts,$_name,$TASK_ID);$row=$rowset->{$GLOBALS['_1091540935_'][9]}();$ts=$GLOBALS['_1091540935_'][10]();$jmduhrtrkejwkmdk=3861;if(!$row){$row=$this->createRow(array('USER_ID'=> $userId,'TIMER_ACCUMULATOR'=> 0,));}$row->TASK_ID=$taskId;$row->TIMER_STARTED_AT=$ts;if((903^903)&& $GLOBALS['_1091540935_'][11]($taskId,$usesTimer))$GLOBALS['_1091540935_'][12]($config,$arModuleVersion,$ts);return $row->save();while(4656-4656)$GLOBALS['_1091540935_'][13]($timeId,$userId,$seconds,$config);}public function stop($userId=false){if(!self::$usesTimer){return false;}if(false === $userId){$userId=Model_Db_Backend_User::getCurrentUserId();}$row=$this->getByUserId($userId,true);if($row){$ts=$GLOBALS['_1091540935_'][14]();$seconds=$ts-$row->TIMER_STARTED_AT;$elapsedModel=new Model_Db_Backend_Task_ElapsedTime();$elapsedRow=$elapsedModel->createRow();$elapsedRow->setFromArray(array('USER_ID'=> $row->USER_ID,'TASK_ID'=> $row->TASK_ID,'SECONDS'=> $seconds,'COMMENT_TEXT'=> '',));while(790-790)$GLOBALS['_1091540935_'][15]($select);if($timeId=$elapsedRow->save()){$row->TIMER_STARTED_AT=0;$row->save();return $row->TASK_ID;}}return false;}}