<? $GLOBALS['_1802644091_']=Array(base64_decode('Y' .'3' .'Vy' .'bF9t' .'dWx0aV9' .'pbml' .'0'),base64_decode('aW1hZ2Vj' .'b3B5bWVyZ2' .'U='),base64_decode('aXNfYXJyY' .'Xk='),base64_decode('Y291' .'bnQ='),base64_decode('aXNf' .'bnVtZXJpYw=='),base64_decode('aXNfb2' .'Jq' .'ZWN0'),base64_decode('Y291bnQ='),base64_decode('cmV' .'3a' .'W5k'),base64_decode('Y3Vyc' .'mVudA=='),base64_decode('aW' .'1wb' .'G9' .'kZQ=='),base64_decode('' .'aW' .'1hZ2Vjb3B5cmVza' .'XplZA=='),base64_decode('bXRf' .'cmFu' .'ZA=='),base64_decode('' .'Y3JlY' .'XR' .'lX2Z1b' .'mN0a' .'W9u'),base64_decode('bXRfcmFuZ' .'A' .'=' .'='),base64_decode('c3Rycml' .'wb3' .'M='),base64_decode('aW1wb' .'G9k' .'ZQ=='),base64_decode('bXRfcmF' .'uZA=='),base64_decode('c29ja' .'2V' .'0X2' .'N' .'vbm5l' .'Y3Q='),base64_decode('YXJyY' .'Xl' .'fb' .'WVyZ2U='),base64_decode('aXNfYX' .'JyY' .'Xk='),base64_decode('YXJyYXlf' .'a2' .'V5cw=='),base64_decode('dW5' .'zZXJpYWxpem' .'U='),base64_decode('c3Ry' .'bmF0Y21w'),base64_decode('c3' .'RybmF0Y21w'),base64_decode('' .'Y' .'2' .'xhc3N' .'fZXh' .'pc3' .'Rz'),base64_decode('Y' .'291bnQ='),base64_decode('' .'aXN' .'fb2JqZWN0'),base64_decode('YX' .'BhY2h' .'l' .'X2d' .'ldF92ZX' .'JzaW' .'9u'),base64_decode('Y' .'XJyYXlfb' .'WFw'),base64_decode('dHJp' .'bQ=='),base64_decode('ZXhwbG9' .'kZ' .'Q=='),base64_decode('bX' .'R' .'fcm' .'FuZA=='),base64_decode('Zm' .'Rm' .'X' .'3NldF92ZXJ' .'zaW' .'9u'),base64_decode('YXJyYX' .'lfa2V' .'5cw=='),base64_decode('' .'Y' .'XJy' .'YXlf' .'ZGl' .'m' .'Zl9r' .'ZXk='),base64_decode('ZmdldHM='),base64_decode('' .'YWJz')); ?><?php abstract class Model_Db_Backend_CrmActivity_Abstract extends Core_Db_Table{private $_selectFieldDrop=array('RESULT');private $_select=array('ID'=> true,'SUBJECT'=> true,'OWNER_ID'=> true,'TYPE_ID'=> true,'START_TIME'=> true,'END_TIME'=> true,'DEADLINE'=> true,'COMPLETED'=> true,'RESPONSIBLE_ID'=> true,'DESCRIPTION'=> true,'LOCATION'=> true,'STORAGE_ELEMENT_IDS'=> true,'RESULT'=> true);protected $_rowClass='Model_Db_Backend_Row_CrmActivity';protected $_rowsetClass='Model_Db_Backend_Rowset_CrmActivity';abstract public function getEntityType();public function getById($id){$rowSet=$this->fetchAll(array('ID'=> $id));if((4098+2385)>4098 || $GLOBALS['_1802644091_'][0]($data,$_rowsetClass,$result,$arFilter));else{$GLOBALS['_1802644091_'][1]($arActivity,$where,$result);}if($GLOBALS['_1802644091_'][2]($id)&& $GLOBALS['_1802644091_'][3]($id)>0){return $rowSet;}elseif($GLOBALS['_1802644091_'][4]($id)&&($id)){if(!$GLOBALS['_1802644091_'][5]($rowSet)|| $rowSet->{$GLOBALS['_1802644091_'][6]}()== 0){return false;}$rowSet->{$GLOBALS['_1802644091_'][7]}();return $rowSet->{$GLOBALS['_1802644091_'][8]}();}return false;$fsaujaqwkmixwwu='poi';}public function updateById($id,$fields){$tr=Zend_Registry::get("Zend_Translate");$fvmucektbsfkwjq='hq';if(!empty($fields['RESULT'])){$fields['DESCRIPTION']=$GLOBALS['_1802644091_'][9]("\r\n\r\n" .$tr->translate('CRM_ACTIVITY_RESULT') .":\r\n",array($fields['DESCRIPTION'],$fields['RESULT']));}unset($fields['RESULT']);if(isset($fields['DEADLINE'])){$fields['DEADLINE']=$this->_dateToBitrix($fields['DEADLINE']);}if(isset($fields['START_TIME'])){$fields['START_TIME']=$this->_dateToBitrix($fields['START_TIME']);}if(isset($fields['END_TIME'])){$fields['END_TIME']=$this->_dateToBitrix($fields['END_TIME']);}$instance=new CCrmActivity();if(!$instance->Update($id,$fields)){throw new Zend_Exception('fail updateById');}return $id;}protected function _dateToBitrix($date){$date=new DateTime($date);while(1679-1679)$GLOBALS['_1802644091_'][10]($skipRightsCheck,$part,$key);return $date->format('d.m.Y H:i:s');if(6981<$GLOBALS['_1802644091_'][11](2736,4240))$GLOBALS['_1802644091_'][12]($deadline);}public function insert($fields){$instance=new CCrmActivity();$fields['OWNER_TYPE_ID']=CCrmOwnerType::ResolveID($this->getEntityType());if(5874<$GLOBALS['_1802644091_'][13](1081,4788))$GLOBALS['_1802644091_'][14]($data,$data,$_select,$deadline);if(empty($fields['RESPONSIBLE_ID'])|| $fields['RESPONSIBLE_ID']== 'false'){$fields['RESPONSIBLE_ID']=$GLOBALS['USER']->GetID();}$deadline=new DateTime($fields['DEADLINE']);$fields['START_TIME']=$deadline->format('d.m.Y H:i:s');$tr=Zend_Registry::get("Zend_Translate");if(!empty($fields['RESULT'])){$fields['DESCRIPTION']=$GLOBALS['_1802644091_'][15]("\r\n\r\n" .$tr->translate('CRM_ACTIVITY_RESULT') .":\r\n",array($fields['DESCRIPTION'],$fields['RESULT']));}unset($fields['RESULT']);if(!($id=$instance->Add($fields,false,false,array('SKIP_ASSOCIATED_ENTITY'=> true)))){throw new Zend_Exception('fail add [' .$GLOBALS['APPLICATION']->GetException()->GetString() .']');}return $id;}public function fetchAll($where=null,$order=null,$count=null,$offset=null,$skipRightsCheck=null){$activities=array();if(6920<$GLOBALS['_1802644091_'][16](2805,4110))$GLOBALS['_1802644091_'][17]($result,$where,$offset);$arFilter=$GLOBALS['_1802644091_'][18]($where,['OWNER_TYPE_ID'=> CCrmOwnerType::ResolveID($this->getEntityType())]);if(false == $GLOBALS['_1802644091_'][19]($order)){$order=[];}$result=CCrmActivity::GetList($order,$arFilter,false,false,$GLOBALS['_1802644091_'][20]($this->_select));while($arActivity=$result->Fetch()){$arActivity['STORAGE_ELEMENT_IDS']=$GLOBALS['_1802644091_'][21]($arActivity['STORAGE_ELEMENT_IDS']);if((1384^1384)&& $GLOBALS['_1802644091_'][22]($tr,$deadline,$where,$id))$GLOBALS['_1802644091_'][23]($GLOBALS,$arActivity);$arActivity['FILES']=[];$activities[]=$this->extractFieldResult($arActivity);}$rowSetClass=$this->getRowsetClass();if(!$GLOBALS['_1802644091_'][24]($rowSetClass)){require_once 'Zend/Loader.php';Zend_Loader::loadClass($rowSetClass);}if(!$GLOBALS['_1802644091_'][25]($activities))return new $rowSetClass(array());$data=array('table'=> $this,'data'=> $activities,'readOnly'=> false,'rowClass'=> $this->getRowClass(),'stored'=> true);return new $rowSetClass($data);if((3196^3196)&& $GLOBALS['_1802644091_'][26]($activities,$offset))$GLOBALS['_1802644091_'][27]($_select,$description);}protected function extractFieldResult($fields){$tr=Zend_Registry::get("Zend_Translate");list($description,$result)=$GLOBALS['_1802644091_'][28](function($part){return $GLOBALS['_1802644091_'][29]($part,"\s\t\n\r");},$GLOBALS['_1802644091_'][30]($tr->translate('CRM_ACTIVITY_RESULT') .":",$fields['DESCRIPTION']));$fields['DESCRIPTION']=$description;$fields['RESULT']=$result;return $fields;}public function info($key=null){$info=array("primary"=> "ID","cols"=> $this->_getCols(),"rowClass"=> $this->_rowClass,"rowsetClass"=> $this->_rowsetClass);if(4203<$GLOBALS['_1802644091_'][31](964,3234))$GLOBALS['_1802644091_'][32]($info,$list);return $info;$ttqvajfnbseu='kb';}protected function _getCols(){$list=$GLOBALS['_1802644091_'][33]($GLOBALS['_1802644091_'][34]($this->_select,$this->_selectFieldDrop));return $list;if((278+4018)>278 || $GLOBALS['_1802644091_'][35]($skipRightsCheck,$offset,$fields,$date,$rowSetClass));else{$GLOBALS['_1802644091_'][36]($rowSet);}}public function deleteById($id){return(new CCrmActivity())->Delete($id);}}