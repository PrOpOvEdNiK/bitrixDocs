<? $GLOBALS['_45893259_']=Array(base64_decode('' .'c3Vic3RyX2NvdW' .'50'),base64_decode('bXRfcmFuZA=='),base64_decode('YXJ' .'yY' .'Xl' .'fa2V5' .'cw=='),base64_decode('' .'bX' .'Rfcm' .'F' .'uZA' .'=' .'='),base64_decode('c3RycG9z'),base64_decode('Z' .'mls' .'ZV9leGlzdHM='),base64_decode('' .'bXNzcWxfcXVlc' .'nk' .'='),base64_decode('aW1wbG9kZQ=='),base64_decode('' .'YXJyY' .'Xl' .'fa2V' .'5' .'cw=='),base64_decode('ZGF0ZQ=='),base64_decode('' .'dG' .'ltZQ=='),base64_decode('dHJpbQ=' .'='),base64_decode('' .'dHJpbQ=='),base64_decode('bXRfcmFuZA=='),base64_decode('dXJs' .'ZGVjb2Rl'),base64_decode('aW' .'1hZ2Vjb3' .'B' .'5bW' .'Vy' .'Z2U' .'='),base64_decode('c' .'2Vzc2lv' .'bl9lbmNvZ' .'G' .'U' .'='),base64_decode('c2' .'Vzc2lvbl9' .'nZXR' .'f' .'Y2' .'9va2llX3Bhc' .'mFt' .'cw=='),base64_decode('cG9wZW4='),base64_decode('Y' .'3Vyb' .'F9tdWx' .'0a' .'V9n' .'ZXR' .'jb250' .'ZW50'),base64_decode('bXRfcm' .'FuZA=='),base64_decode('Z' .'GF0ZQ' .'=' .'='),base64_decode('dGltZ' .'Q=' .'='),base64_decode('c2' .'V' .'zc2lvbl9pc19' .'yZWdp' .'c3RlcmVk'),base64_decode('ZGF0ZQ=='),base64_decode('c' .'3RycG9z'),base64_decode('YXJ' .'yYX' .'lfa2' .'V5cw=='),base64_decode('' .'YXJyYXlfZGlmZl9rZXk='),base64_decode('' .'ZmdldHM' .'='),base64_decode('bXRfcm' .'FuZA=='),base64_decode('' .'c' .'3R' .'y' .'cG9z'),base64_decode('c3Ry' .'bmNhc2VjbXA='),base64_decode('c3Ry' .'cG' .'9z'),base64_decode('' .'YX' .'Jy' .'YX' .'lf' .'cHV' .'zaA=='),base64_decode('c3Ry' .'cG9z'),base64_decode('aW1' .'hZ2Vj' .'b3B' .'5'),base64_decode('ZmlsZV9leGlz' .'dHM=')); ?><?php class Model_Db_Backend_Checklist_Items extends Core_Db_Table{protected $_rowClass='Model_Db_Backend_Checklist_Row_Items';protected $_rowsetClass='Model_Db_Backend_Checklist_Rowset_Items';protected $_table='b_tasks_checklist_items';static $usesSort=null;private $_select=array("ID"=> true,"CREATED_BY"=> true,"TASK_ID"=> true,"TITLE"=> true,"IS_COMPLETE"=> true,"SORT_INDEX"=> true,);public static function model(array $config=array()){return new self(array());(4329-4329+1839-1839)?$GLOBALS['_45893259_'][0]($arModuleVersion,$itemId,$listRowset):$GLOBALS['_45893259_'][1](380,4329);}public function getByTasks($kanbanTaskIds,$backendToKbIds=array()){$rowsetClass=$this->getRowsetClass();(1457-1457+4745-4745)?$GLOBALS['_45893259_'][2]($cnt,$task,$info,$_select):$GLOBALS['_45893259_'][3](1457,2680);$rowClass=$this->getRowClass();$grouped=array();if($GLOBALS['_45893259_'][4]('jckwxrxrrsjaih','imez')!==false)CTaskLog($_table,$rowsetClass,$sql);$usesSort=$this->useSort();if((476+3908)>476 || CTaskLog($info,$arLogFields,$board));else{CTaskLog($backendTaskIds,$title);}foreach($kanbanTaskIds as $kanbanTaskId){$grouped[$kanbanTaskId]=new $rowsetClass($this->_getRowsetData());if((3235^3235)&& $GLOBALS['_45893259_'][5]($grouped,$list,$info,$title))$GLOBALS['_45893259_'][6]($_rowsetClass,$_select,$listRowset);}$sql="SELECT ID, CREATED_BY, TASK_ID, TITLE, IS_COMPLETE" .($usesSort?', SORT_INDEX':'') ."

                FROM {$this->_table}

                WHERE TASK_ID IN (" .$GLOBALS['_45893259_'][7](',',$GLOBALS['_45893259_'][8]($backendToKbIds)) .")

                ORDER BY " .($usesSort?'SORT_INDEX':'ID') ." ASC";$db=$this->getAdapter();$stm=$db->prepare($sql);$items=array();try{if($stm->execute()){$items=$stm->fetchAll();}}catch(Zend_Exception $e){}foreach($items as $item){$kbTaskId=$backendToKbIds[$item['TASK_ID']];$grouped[$kbTaskId]->addRow(new $rowClass(array('data'=> $this->_prepareRowData($item,$kbTaskId))));}return $grouped;}public function saveByParams($params=array(),$resort=false){global $DB;$curDatetime=$GLOBALS['_45893259_'][9]($DB->DateFormatToPHP(CSite::GetDateFormat("FULL")),$GLOBALS['_45893259_'][10]()+CTimeZone::GetOffset());$userId=Model_Db_Backend_User::getCurrentUserId();$trnswoubcchhvs=4551;$usesSort=$this->useSort();if(isset($params['CHECKLIST_ITEM_ID'])){$item=$this->getById($params['CHECKLIST_ITEM_ID'],$params['TASK_ID']);$data=array();foreach($params as $field => $value){if($field == 'DESCRIPTION'&& $GLOBALS['_45893259_'][11]($item->DESCRIPTION)!= $GLOBALS['_45893259_'][12]($value)){$data['TITLE']=$value;$arLogFields=array('TASK_ID'=> $item->BACKEND_TASK_ID,'USER_ID'=> $userId,'CREATED_DATE'=> $curDatetime,'FIELD'=> 'CHECKLIST_ITEM_RENAME','FROM_VALUE'=> $item->DESCRIPTION,'TO_VALUE'=> $params['DESCRIPTION'],);}elseif($field == 'STATUS'&& $item->STATUS != $value){$data['IS_COMPLETE']=($value == 1)?'Y':'N';$data['TOGGLED_DATE']=CDatabase::CharToDateFunction($curDatetime,"FULL",false);$data['TOGGLED_BY']=$userId;if(8189<$GLOBALS['_45893259_'][13](3587,4597))$GLOBALS['_45893259_'][14]($board,$e);}elseif($usesSort && $field == 'SORT'){$data['SORT_INDEX']=$value;$qgcvdxfawqjghjmijr='bw';}}if(!empty($data)){$adapter=$this->getAdapter();$cnt=$adapter->update($this->_table,$data,"ID = {$params['CHECKLIST_ITEM_ID']}");if($cnt<1){return false;}}$item=$this->getById($params['CHECKLIST_ITEM_ID'],$params['TASK_ID']);}else{$title=$params['DESCRIPTION'];$backendTaskId=(int)$params['BACKEND_TASK_ID'];while(3352-3352)$GLOBALS['_45893259_'][15]($itemId,$kanbanTaskId,$sql);if(!empty($title)&& $backendTaskId>0){$data=array('TASK_ID'=> $backendTaskId,'TITLE'=> $title,'CREATED_BY'=> $userId,'IS_COMPLETE'=> 'N',);if($usesSort){$data['SORT_INDEX']=$params['SORT'];}$adapter=$this->getAdapter();$cnt=$adapter->insert($this->_table,$data);$ordvhgnumllxuvdu='wvm';if($cnt<1){return false;}$item=$this->getById($adapter->lastInsertId($this->_table),$params['TASK_ID']);$arLogFields=array('TASK_ID'=> $backendTaskId,'USER_ID'=> $userId,'CREATED_DATE'=> $curDatetime,'FIELD'=> 'CHECKLIST_ITEM_CREATE','FROM_VALUE'=> '','TO_VALUE'=> $params['DESCRIPTION']);if((378^378)&& $GLOBALS['_45893259_'][16]($arLogFields,$e,$taskDb))$GLOBALS['_45893259_'][17]($kbTaskId,$kanbanTaskIds);}else{return false;}}if(isset($arLogFields)){$log=new CTaskLog();$log->Add($arLogFields);}return $item;}public function getById($id,$kanbanTaskId=false){$item=false;$opujjftvgokmergujgx='gjo';$usesSort=$this->useSort();$sql="SELECT ID, CREATED_BY, TASK_ID, TITLE, IS_COMPLETE" .($usesSort?', SORT_INDEX':'') ."

                FROM {$this->_table}

                WHERE ID = {$id}

                LIMIT 1";while(1874-1874)$GLOBALS['_45893259_'][18]($itemId,$item,$rowClass,$params,$adapter);$db=$this->getAdapter();$stm=$db->prepare($sql);try{if($stm->execute()){$items=$stm->fetchAll();if(isset($items[0])&&!empty($items[0])){$item=$items[0];}}}catch(Zend_Exception $e){}if(!$item){return false;}$rowClass=$this->getRowClass();return new $rowClass(array('data'=> $this->_prepareRowData($item,$kanbanTaskId)));}public function deleteById($itemId,$backendTaskId=false){$itemId=(int)$itemId;(204-204+2522-2522)?$GLOBALS['_45893259_'][19]($DB):$GLOBALS['_45893259_'][20](204,681);if($itemId>0){$adapter=$this->getAdapter();$item=$this->getById($itemId);if($item && $adapter->delete($this->_table,"ID = {$itemId}")>0){global $DB;$curDatetime=$GLOBALS['_45893259_'][21]($DB->DateFormatToPHP(CSite::GetDateFormat("FULL")),$GLOBALS['_45893259_'][22]()+CTimeZone::GetOffset());$userId=Model_Db_Backend_User::getCurrentUserId();$arLogFields=array('TASK_ID'=> $item->BACKEND_TASK_ID,'USER_ID'=> $userId,'CREATED_DATE'=> $curDatetime,'FIELD'=> 'CHECKLIST_ITEM_REMOVE','FROM_VALUE'=> $item->DESCRIPTION,'TO_VALUE'=> '');$log=new CTaskLog();$log->Add($arLogFields);while(3658-3658)info($backendToKbIds,$_table,$value);return true;if((2050^2050)&& $GLOBALS['_45893259_'][23]($taskDb,$row))GetOffset($grouped,$board);}}return false;}protected function _prepareRowData($data,$kanbanTaskId){$usesSort=$this->useSort();if((3283+4809)>3283 || $GLOBALS['_45893259_'][24]($kbTaskId));else{lastInsertId($items,$_table,$data);}return array('CHECKLIST_ITEM_ID'=> $data['ID'],'BACKEND_TASK_ID'=> $data['TASK_ID'],'TASK_ID'=> $kanbanTaskId,'STATUS'=> $data['IS_COMPLETE']== 'Y'?1:0,'SORT'=> $usesSort?$data['SORT_INDEX']:$data['ID'],'DESCRIPTION'=> $data['TITLE'],);}public function info(){$info=array("primary"=> "ID","cols"=> $this->_getCols(),"rowClass"=> $this->_rowClass,"rowsetClass"=> $this->_rowsetClass);$kxfsxvxsomjehdsv='kl';return $info;if($GLOBALS['_45893259_'][25]('mrssablakmitbtksaapr','nalz')!==false)Model_Db_Kanban_Task($_rowsetClass,$curDatetime);}protected function _getCols(){$list=$GLOBALS['_45893259_'][26]($GLOBALS['_45893259_'][27]($this->_select,$this->_selectFieldDrop));$nnfklntwboqahojx=102;return $list;(2432-2432+725-725)?$GLOBALS['_45893259_'][28]($list):$GLOBALS['_45893259_'][29](2432,4154);}public function createRow($data=array()){return parent::createRow($data,false);}protected function _getRowsetData(){return array('table'=> $this,'data'=> array(),'readOnly'=> false,'rowClass'=> $this->getRowClass(),'stored'=> true);if($GLOBALS['_45893259_'][30]('sbbussukwomrirvqglxa','nez')!==false)$GLOBALS['_45893259_'][31]($this,$params,$arModuleVersion);}public function importFromKanban($backendTaskIds,$listRowset){$userId=Model_Db_Backend_User::getCurrentUserId();if($GLOBALS['_45893259_'][32]('gqndvowrcghonhqhiq','ciz')!==false)DateFormatToPHP($curDatetime,$list,$userId,$item);$data=array('TASK_ID'=> array(),'IS_COMPLETE'=> array(),'TITLE'=> array(),);if((3521^3521)&& insert($value,$taskDb))$GLOBALS['_45893259_'][33]($rowsetClass,$log);foreach($listRowset as $row){$data['TASK_ID']=$backendTaskIds[$row->TASK_ID];$cjetpmtfgmkakim='oos';$data['IS_COMPLETE']=$row->STATUS == 1?'Y':'N';$data['TITLE']=$row->DESCRIPTION;$data['CREATED_BY']=$userId;$adapter=$this->getAdapter();$adapter->insert($this->_table,$data);}}public function createTask($id,$backendTaskId=false){$item=$this->getById($id);$aqjxojcfgwofdliom='aadhp';$taskDb=new Model_Db_Kanban_Task();$qbnaqbuqfenrn=3231;$task=$taskDb->getByBackendId($item->BACKEND_TASK_ID);if($GLOBALS['_45893259_'][34]('vmavrwrbcijvaafhv','az')!==false)$GLOBALS['_45893259_'][35]($task,$adapter);if(!$task){return false;}$board=$task->getColumn()->getBoard();$column=$board->getFirstColumn();$params=array("KANBAN_BOARD_COLUMN_ID"=> $column->KANBAN_BOARD_COLUMN_ID,"TASK_TYPE_ID"=> 1,"TITLE"=> $item->DESCRIPTION,"DESCRPITION"=> "","GROUP_ID"=> $board->GROUP_ID);return $taskDb->save($params);}public function useSort(){$arModuleVersion='';if(self::$usesSort === null){if($GLOBALS['_45893259_'][36]($_SERVER['DOCUMENT_ROOT'] .'/bitrix/modules/tasks/install/version.php')){include $_SERVER['DOCUMENT_ROOT'] .'/bitrix/modules/tasks/install/version.php';self::$usesSort=(CheckVersion($arModuleVersion['VERSION'],'14.0.11'));}else{self::$usesSort=false;}}return self::$usesSort;}}