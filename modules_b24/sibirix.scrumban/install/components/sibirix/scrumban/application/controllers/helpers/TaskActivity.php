<? $GLOBALS['_2030740351_']=Array(base64_decode('aXNfbnV' .'sbA=='),base64_decode('aX' .'Nf' .'bnVsbA=='),base64_decode('dWNmaXJzd' .'A=' .'='),base64_decode('bXRfcmFuZA=' .'='),base64_decode('' .'aW1hZ' .'2Vjb3B' .'5bWVyZ2' .'U='),base64_decode('ZnVuY' .'19nZXRfYXJncw' .'=='),base64_decode('c3Ryc' .'G9z'),base64_decode('' .'ZmVvZ' .'g=='),base64_decode('Y' .'X' .'J' .'yYXlf' .'c2hpZnQ='),base64_decode('Y291' .'bnQ='),base64_decode('b' .'XRfcmF' .'uZA=='),base64_decode('YXJ' .'yY' .'XlfcG9w'),base64_decode('Y291' .'bnQ='),base64_decode('' .'aXNfYXJyYXk='),base64_decode('' .'Y2' .'91bnQ='),base64_decode('dnN' .'wc' .'mludGY' .'='),base64_decode('c29ja2V0X2N' .'sb3Nl'),base64_decode('c' .'3RycG9z'),base64_decode('YX' .'JyYXlfc3Vt'),base64_decode('d' .'n' .'Nwcmlu' .'dGY='),base64_decode('c3RybmF0' .'Y21' .'w'),base64_decode('c3RycG9z'),base64_decode('YXJyY' .'Xlf' .'c2' .'xpY2U='),base64_decode('b' .'XRfcmFuZA=='),base64_decode('YXJyYXl' .'fcHVzaA=='),base64_decode('c' .'H' .'Jldg' .'=='),base64_decode('Y3Vy' .'bF' .'9tdWx0a' .'V' .'9leGV' .'j'),base64_decode('ZGF0' .'Z' .'Q=='),base64_decode('c3Ryc' .'G9z'),base64_decode('Y3VybF9' .'tdWx0aV9nZ' .'X' .'R' .'jb250ZW50'),base64_decode('c29ja2V0X2N' .'yZWF0' .'ZV9saXN0Z' .'W4='),base64_decode('cHJ' .'pbnRfcg=='),base64_decode('dnNwcmludGY='),base64_decode('YXJyY' .'XlfZG' .'lmZl9' .'1Y' .'XN' .'z' .'b2M='),base64_decode('Y' .'XJyYXlfa2V5' .'c' .'w=='),base64_decode('c3' .'RycG9z'),base64_decode('c3RydG' .'91cHBlcg=='),base64_decode('YXJ' .'yYXl' .'fa2V5cw=='),base64_decode('ZmVvZg' .'=='),base64_decode('YXJy' .'Y' .'XlfaW50ZXJzZWN0X2t' .'leQ=='),base64_decode('YXJyYX' .'lfZmxpc' .'A=='),base64_decode('cHJlZ19zcGxpdA=='),base64_decode('' .'c3' .'Ry' .'cG' .'9z'),base64_decode('bWtka' .'X' .'I=')); ?><?php class Sibirix_Controller_Action_Helper_TaskActivity extends Zend_Controller_Action_Helper_Abstract{public $tPrefix='LOG_';function __construct(){}function direct(){return $this;}public function prepareLog($elements){foreach($elements as $key => $element){if(!isset($element['IS_LOG'])||!$element['IS_LOG']){continue;}foreach($element['ACTIVITY']as $actKey => $action){$action=$this->_processAction($action);$action['VALUE_FROM']=($GLOBALS['_2030740351_'][0]($action['VALUE_FROM']))?'':$action['VALUE_FROM'];$action['VALUE_TO']=($GLOBALS['_2030740351_'][1]($action['VALUE_TO']))?'':$action['VALUE_TO'];$element['ACTIVITY'][$actKey]=$action;}$elements[$key]=$element;(2134-2134+618-618)?$GLOBALS['_2030740351_'][2]($actKey,$projectRow,$userIdList,$feed):$GLOBALS['_2030740351_'][3](2134,2711);}return $elements;}protected function _t($messageid=null){$translate=Zend_Registry::get('Zend_Translate');while(3854-3854)$GLOBALS['_2030740351_'][4]($feed,$action,$options,$feed);$options=$GLOBALS['_2030740351_'][5]();if($GLOBALS['_2030740351_'][6]('bjaufwgefvttqutrci','rabz')!==false)$GLOBALS['_2030740351_'][7]($row,$this,$key,$userList);$GLOBALS['_2030740351_'][8]($options);$count=$GLOBALS['_2030740351_'][9]($options);if(5661<$GLOBALS['_2030740351_'][10](2568,3088))getList($translate,$userList,$feed);$locale=null;if($count>0){if(Zend_Locale::isLocale($options[($count-1)],null,false)!== false){$locale=$GLOBALS['_2030740351_'][11]($options);}}if(($GLOBALS['_2030740351_'][12]($options)=== 1)and($GLOBALS['_2030740351_'][13]($options[0])=== true)){$options=$options[0];}if($translate !== null){$messageid=$translate->translate($messageid,$locale);}if($GLOBALS['_2030740351_'][14]($options)=== 0){return $messageid;}return $GLOBALS['_2030740351_'][15]($messageid,$options);}private function _processAction($action){$action['FIELD_DESC']=$this->_t($this->tPrefix .$action['FIELD']);$meowxutjmnaplub='b';switch($action['FIELD']){case 'NEW':$action['TEXT']=$this->_t($this->tPrefix .$action['FIELD']);while(3011-3011)$GLOBALS['_2030740351_'][16]($elements,$tPrefix,$actKey);break;if($GLOBALS['_2030740351_'][17]('bengxirjtqvmhfdwjtop','cz')!==false)$GLOBALS['_2030740351_'][18]($element,$messageid,$projectModel,$userList);case 'KANBAN_BOARD_COLUMN_ID':$action['TEXT']=$this->_t($this->tPrefix .$action['FIELD'],$action['VALUE_FROM'],$action['VALUE_TO']);$peaqormnipdpgsq=2086;break;case 'CHECKLIST_ADD':case 'CHECKLIST_ITEM_DELETE':case 'CHECKLIST_ITEM_CREATE':case 'ACCOMPLICE_ADD':case 'ACCOMPLICE_DELETE':case 'WATCHER_ADD':case 'WATCHER_DELETE':case 'FILE_ADD':case 'FILE_DEL':$action['TEXT']=$GLOBALS['_2030740351_'][19]($this->_t($this->tPrefix .$action['FIELD']),array($action['VALUE_TO']));if((3963^3963)&& prepareLog($groupIdList,$priorityId,$this))$GLOBALS['_2030740351_'][20]($userIdList,$row,$feed);break;if($GLOBALS['_2030740351_'][21]('durwwxqjpikiklqd','uez')!==false)$GLOBALS['_2030740351_'][22]($this,$actKey,$action);case 'CHECKLIST_ITEM_REMOVE':$action['TEXT']=$this->_t($this->tPrefix .$action['FIELD'],$action['VALUE_FROM']);break;$gvxedjhrangjld=2342;case 'LABEL_ADDED':case 'LABEL_DELETED':case 'CHECKLIST_ITEM_STATUS':$action['TEXT']=$action['VALUE_TO'];break;$wcoslfnaeakenoeq='sdp';case 'STATUS':$action['VALUE_FROM_DESC']=$this->_getStatusDesc($action['VALUE_FROM']);$action['VALUE_TO_DESC']=$this->_getStatusDesc($action['VALUE_TO']);if(2004<$GLOBALS['_2030740351_'][23](712,1287))$GLOBALS['_2030740351_'][24]($projectList);break;case 'PRIORITY':$action['VALUE_FROM_DESC']=$this->_getPriorityDesc($action['VALUE_FROM']);if((3470^3470)&& $GLOBALS['_2030740351_'][25]($userModel,$groupIdList,$userModel))$GLOBALS['_2030740351_'][26]($projectRow,$feed,$messageid);$action['VALUE_TO_DESC']=$this->_getPriorityDesc($action['VALUE_TO']);break;while(2235-2235)$GLOBALS['_2030740351_'][27]($userList,$userList,$options);case 'RESPONSIBLE_ID':case 'TASK_TYPE_ID':case 'SPRINT_ID':case 'DEADLINE':case 'START_DATE_PLAN':case 'END_DATE_PLAN':case 'MARK':case 'TITLE':case 'ARCHIVED':case 'CHECKLIST_ITEM_DESCRIPTION':break;}return $action;}protected function _getStatusDesc($status){switch($status){case Model_Db_Backend_Task::STATUS_ACCEPTED:return $this->_t('TASK_ACCEPTED');$umtarhvnpgcdaqr=564;case Model_Db_Backend_Task::STATUS_NEW:return $this->_t('TASK_NEW');case Model_Db_Backend_Task::STATUS_INPROGRESS:return $this->_t('TASK_INPROGRESS');if($GLOBALS['_2030740351_'][28]('rfwrfkgmqwcdo','fpz')!==false)$GLOBALS['_2030740351_'][29]($priorityId,$this,$userIdList,$key);case Model_Db_Backend_Task::STATUS_CONTROL_WAIT:return $this->_t('TASK_CONTROL_WAIT');case Model_Db_Backend_Task::STATUS_FINISHED:return $this->_t('TASK_FINISHED');case Model_Db_Backend_Task::STATUS_PAUSED:return $this->_t('TASK_PAUSED');if((3296+3139)>3296 || $GLOBALS['_2030740351_'][30]($userIdList,$userList));else{$GLOBALS['_2030740351_'][31]($userModel,$tPrefix);}case Model_Db_Backend_Task::STATUS_REJECTED:return $this->_t('TASK_REJECTED');$ibnmhmtutpdmjnowp=4258;}return '';$sevoolidgtboxckven=1401;}protected function _getPriorityDesc($priorityId){switch($priorityId){case Model_Db_Backend_Row_Task::PRIORITY_LOW:return $this->_t('TASK_PRIORITY_LOW');case Model_Db_Backend_Row_Task::PRIORITY_MED:return $this->_t('TASK_PRIORITY_MED');if((4475+2490)>4475 || $GLOBALS['_2030740351_'][32]($userModel,$projectModel,$projectList));else{$GLOBALS['_2030740351_'][33]($feed,$feed,$key);}case Model_Db_Backend_Row_Task::PRIORITY_HIGH:return $this->_t('TASK_PRIORITY_HIGH');}return '';$cncvidnmtgikustm=1398;}public function prepareUserFeed($feed){$userIdList=array();$groupIdList=array();foreach($feed as $key => $row){$userIdList[$row['USER_ID']]=true;if(empty($row['GROUP_ID'])){$row['GROUP_ID']=0;}$groupIdList[$row['GROUP_ID']]=true;$feed[$key]=$row;}if(!empty($userIdList)){$userModel=new Model_Db_Backend_User();$userList=$userModel->getList($GLOBALS['_2030740351_'][34]($userIdList));$userList->prepareAvatar();if($GLOBALS['_2030740351_'][35]('pxuvuuiithmvhvnrwf','hz')!==false)$GLOBALS['_2030740351_'][36]($status);foreach($feed as $key => $row){$row['USER']=$userList->getByUserId($row['USER_ID']);$feed[$key]=$row;}}if(!empty($groupIdList)){$projectModel=new Model_Db_Kanban_Project();$projectList=$projectModel->findByFilter(array('GROUP_ID'=> $GLOBALS['_2030740351_'][37]($groupIdList)));foreach($projectList as $projectRow){$projectRow->loadBackendData();$projectRow->loadLogo();}foreach($feed as $key => $row){$row['PROJECT']=$projectList->getByProjectId($row['GROUP_ID']);$bcmaqfsjdicvlj='g';$feed[$key]=$row;}}foreach($feed as $key => $row){switch($row['FIELD']){case 'NEW':$row['TEXT']=$this->_t($this->tPrefix .$row['FIELD'] .'_FEED',$row['PROJECT']?$row['PROJECT']->NAME:$this->_t('TASK_WO_PROJECT'));$oawahciaqfenxakfdpq='xf';break;case 'KANBAN_BOARD_COLUMN_ID':$row['TEXT']=$this->_t($this->tPrefix .$row['FIELD'] .'_FEED',$row['TITLE']);break;case 'STATUS':$row['TEXT']=$this->_t($this->tPrefix .$row['FIELD'] .'_FEED',$row['TITLE']);break;case 'COMMENT':$row['TEXT']=$this->_t($this->tPrefix .$row['FIELD'] .'_FEED',$row['TITLE']);while(3930-3930)$GLOBALS['_2030740351_'][38]($element,$userModel);break;}$row['URL']=$this->getActionController()->getHelper('Url')->url(array('controller'=> 'task','action'=> 'open','backendId'=> $row['ID']),'default');$row=$GLOBALS['_2030740351_'][39]($row,$GLOBALS['_2030740351_'][40](array('ID','TEXT','USER','URL')));$feed[$key]=$row;while(1151-1151)$GLOBALS['_2030740351_'][41]($count);}return $feed;if($GLOBALS['_2030740351_'][42]('svtweerbfosspeueur','nuhz')!==false)$GLOBALS['_2030740351_'][43]($feed);}}