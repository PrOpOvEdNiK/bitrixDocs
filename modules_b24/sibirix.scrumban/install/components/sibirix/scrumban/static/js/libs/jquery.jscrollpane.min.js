/*
 * jScrollPane - v2.0.0beta12 - 2012-07-24
 * http://jscrollpane.kelvinluck.com/
 */
(function(e,t,n){e.fn.jScrollPane=function(r){function i(i,s){function J(t){t.preventScrollEvent=true;var r,s,u,y,b,E,S=false,T=false;o=t;if(a===n){b=i.scrollTop();E=i.scrollLeft();i.css({overflow:"hidden",padding:0});f=i.innerWidth()+I;l=i.innerHeight();i.width(f);a=e('<div class="jspPane" />').css("padding",F).append(i.children());c=e('<div class="jspContainer" />').css({width:f+"px",height:l+"px"}).append(a).appendTo(i)}else{i.css("width","");S=o.stickToBottom&&gt();T=o.stickToRight&&yt();y=i.innerWidth()+I!=f||i.outerHeight()!=l;if(y){f=i.innerWidth()+I;l=i.innerHeight();c.css({width:f+"px",height:l+"px"})}if(!y&&q==h&&a.outerHeight()==p){i.width(f);return}q=h;a.css("width","");i.width(f);c.find(">.jspVerticalBar,>.jspHorizontalBar").remove().end()}a.css("overflow","auto");if(t.contentWidth){h=t.contentWidth}else{h=a[0].scrollWidth}p=a[0].scrollHeight;a.css("overflow","");d=h/f;v=p/l;m=v>1&&o.allowedVerticalScroll;g=d>1&&o.allowedHorizontalScroll;if(!(g||m)){i.removeClass("jspScrollable");a.css({top:0,width:c.width()-I});wt();xt();Nt();it()}else{i.addClass("jspScrollable");r=o.maintainPosition&&(w||x);if(r){s=vt();u=mt()}K();G();Z();if(r){pt(T?h-f:s,false);ht(S?p-l:u,false)}St();bt();Lt();if(o.enableKeyboardNavigation){Tt()}if(o.clickOnTrack){rt()}Ct();if(o.hijackInternalLinks){kt()}}if(o.autoReinitialise&&!j){j=setInterval(function(){J(o)},o.autoReinitialiseDelay)}else{if(!o.autoReinitialise&&j){clearInterval(j)}}i.trigger("jsp-initialised",[g||m]);t.preventScrollEvent=false}function K(){if(m){c.append(e('<div class="jspVerticalBar" />').append(e('<div class="jspCap jspCapTop" />'),e('<div class="jspTrack" />').append(e('<div class="jspDrag" />').append(e('<div class="jspDragTop" />'),e('<div class="jspDragBottom" />'))),e('<div class="jspCap jspCapBottom" />')));T=c.find(">.jspVerticalBar");N=T.find(">.jspTrack");y=N.find(">.jspDrag");if(o.showArrows){A=e('<a class="jspArrow jspArrowUp" />').bind("mousedown.jsp",tt(0,-1)).bind("click.jsp",Et);O=e('<a class="jspArrow jspArrowDown" />').bind("mousedown.jsp",tt(0,1)).bind("click.jsp",Et);if(o.arrowScrollOnHover){A.bind("mouseover.jsp",tt(0,-1,A));O.bind("mouseover.jsp",tt(0,1,O))}et(N,o.verticalArrowPositions,A,O)}k=l;c.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each(function(){k-=e(this).outerHeight()});y.hover(function(){y.addClass("jspHover")},function(){y.removeClass("jspHover")}).bind("mousedown.jsp",function(t){e("html").bind("dragstart.jsp selectstart.jsp",Et);y.addClass("jspActive");var n=t.pageY-y.position().top;e("html").bind("mousemove.jsp",function(e){ot(e.pageY-n,false)}).bind("mouseup.jsp mouseleave.jsp",st);return false});Q()}}function Q(){N.height(k+"px");w=0;C=o.verticalGutter+N.outerWidth();a.width(f-C-I);try{if(T.position().left===0){a.css("margin-left",C+"px")}}catch(e){}}function G(){if(g){c.append(e('<div class="jspHorizontalBar" />').append(e('<div class="jspCap jspCapLeft" />'),e('<div class="jspTrack" />').append(e('<div class="jspDrag" />').append(e('<div class="jspDragLeft" />'),e('<div class="jspDragRight" />'))),e('<div class="jspCap jspCapRight" />')));M=c.find(">.jspHorizontalBar");_=M.find(">.jspTrack");E=_.find(">.jspDrag");if(o.showArrows){H=e('<a class="jspArrow jspArrowLeft" />').bind("mousedown.jsp",tt(-1,0)).bind("click.jsp",Et);B=e('<a class="jspArrow jspArrowRight" />').bind("mousedown.jsp",tt(1,0)).bind("click.jsp",Et);if(o.arrowScrollOnHover){H.bind("mouseover.jsp",tt(-1,0,H));B.bind("mouseover.jsp",tt(1,0,B))}et(_,o.horizontalArrowPositions,H,B)}E.hover(function(){E.addClass("jspHover")},function(){E.removeClass("jspHover")}).bind("mousedown.jsp",function(t){e("html").bind("dragstart.jsp selectstart.jsp",Et);E.addClass("jspActive");var n=t.pageX-E.position().left;e("html").bind("mousemove.jsp",function(e){at(e.pageX-n,false)}).bind("mouseup.jsp mouseleave.jsp",st);return false});D=c.innerWidth();Y()}}function Y(){c.find(">.jspHorizontalBar>.jspCap:visible,>.jspHorizontalBar>.jspArrow").each(function(){D-=e(this).outerWidth()});_.width(D+"px");x=0}function Z(){if(g&&m){var t=_.outerHeight(),n=N.outerWidth();k-=t;e(M).find(">.jspCap:visible,>.jspArrow").each(function(){D+=e(this).outerWidth()});D-=n;l-=n;f-=t;_.parent().append(e('<div class="jspCorner" />').css("width",t+"px"));Q();Y()}if(g){a.width(c.outerWidth()-I+"px")}p=a.outerHeight();v=p/l;if(g){P=Math.ceil(1/d*D);if(P>o.horizontalDragMaxWidth){P=o.horizontalDragMaxWidth}else{if(P<o.horizontalDragMinWidth){P=o.horizontalDragMinWidth}}E.width(P+"px");S=D-P;ft(x)}if(m){L=Math.ceil(1/v*k);if(L>o.verticalDragMaxHeight){L=o.verticalDragMaxHeight}else{if(L<o.verticalDragMinHeight){L=o.verticalDragMinHeight}}y.height(L+"px");b=k-L;ut(w)}}function et(e,t,n,r){var i="before",s="after",o;if(t=="os"){t=/Mac/.test(navigator.platform)?"after":"split"}if(t==i){s=t}else{if(t==s){i=t;o=n;n=r;r=o}}e[i](n)[s](r)}function tt(e,t,n){return function(){nt(e,t,this,n);this.blur();return false}}function nt(t,n,r,i){r=e(r).addClass("jspActive");var s,a,f=true,l=function(){if(t!==0){u.scrollByX(t*o.arrowButtonSpeed)}if(n!==0){u.scrollByY(n*o.arrowButtonSpeed)}a=setTimeout(l,f?o.initialDelay:o.arrowRepeatFreq);f=false};l();s=i?"mouseout.jsp":"mouseup.jsp";i=i||e("html");i.bind(s,function(){r.removeClass("jspActive");a&&clearTimeout(a);a=null;i.unbind(s)})}function rt(){it();if(m){N.bind("mousedown.jsp",function(t){if(t.originalTarget===n||t.originalTarget==t.currentTarget){var r=e(this),i=r.offset(),s=t.pageY-i.top-w,a,f=true,c=function(){var e=r.offset(),n=t.pageY-e.top-L/2,i=l*o.scrollPagePercent,d=b*i/(p-l);if(s<0){if(w-d>n){u.scrollByY(-i)}else{ot(n)}}else{if(s>0){if(w+d<n){u.scrollByY(i)}else{ot(n)}}else{h();return}}a=setTimeout(c,f?o.initialDelay:o.trackClickRepeatFreq);f=false},h=function(){a&&clearTimeout(a);a=null;e(document).unbind("mouseup.jsp",h)};c();e(document).bind("mouseup.jsp",h);return false}})}if(g){_.bind("mousedown.jsp",function(t){if(t.originalTarget===n||t.originalTarget==t.currentTarget){var r=e(this),i=r.offset(),s=t.pageX-i.left-x,a,l=true,c=function(){var e=r.offset(),n=t.pageX-e.left-P/2,i=f*o.scrollPagePercent,d=S*i/(h-f);if(s<0){if(x-d>n){u.scrollByX(-i)}else{at(n)}}else{if(s>0){if(x+d<n){u.scrollByX(i)}else{at(n)}}else{p();return}}a=setTimeout(c,l?o.initialDelay:o.trackClickRepeatFreq);l=false},p=function(){a&&clearTimeout(a);a=null;e(document).unbind("mouseup.jsp",p)};c();e(document).bind("mouseup.jsp",p);return false}})}}function it(){if(_){_.unbind("mousedown.jsp")}if(N){N.unbind("mousedown.jsp")}}function st(){e("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp");if(y){y.removeClass("jspActive")}if(E){E.removeClass("jspActive")}}function ot(e,t){if(!m){return}if(e<0){e=0}else{if(e>b){e=b}}if(t===n){t=o.animateScroll}if(t){u.animate(y,"top",e,ut)}else{y.css("top",e);ut(e)}}function ut(e){if(e===n){e=y.position().top}c.scrollTop(0);w=e;var t=w===0,s=w==b,o=e/b,u=-o*(p-l);if(R!=t||z!=s){R=t;z=s;i.trigger("jsp-arrow-change",[R,z,U,W])}lt(t,s);a.css("top",u);i.trigger("jsp-scroll-y",[-u,t,s]);if(!r.preventScrollEvent){i.trigger("scroll")}if(r.scrollCallback){r.scrollCallback("y",this,r,r.preventScrollEvent)}}function at(e,t,r){if(!g){return}if(e<0){e=0}else{if(e>S){e=S}}if(t===n){t=o.animateScroll}if(t){if(r){u.animate(E,"left",e,function(t,n){ft.apply(this,[t,n]);if(t==e){r()}})}else{u.animate(E,"left",e,ft)}u.animate(E,"left",e,ft)}else{E.css("left",e);ft(e)}}function ft(e){if(e===n){e=E.position().left}c.scrollTop(0);x=e;var t=x===0,s=x==S,o=e/S,u=-o*(h-f);if(U!=t||W!=s){U=t;W=s;i.trigger("jsp-arrow-change",[R,z,U,W])}ct(t,s);a.css("left",u);i.trigger("jsp-scroll-x",[-u,t,s]);if(!r.preventScrollEvent){i.trigger("scroll")}if(r.scrollCallback){r.scrollCallback("x",this,r,r.preventScrollEvent)}}function lt(e,t){if(o.showArrows){A[e?"addClass":"removeClass"]("jspDisabled");O[t?"addClass":"removeClass"]("jspDisabled")}}function ct(e,t){if(o.showArrows){H[e?"addClass":"removeClass"]("jspDisabled");B[t?"addClass":"removeClass"]("jspDisabled")}}function ht(e,t){var n=e/(p-l);ot(n*b,t)}function pt(e,t,n){var r=e/(h-f);at(r*S,t,n)}function dt(t,n,r){var i,s,u,a=0,h=0,p,d,v,m,g,y;try{i=e(t)}catch(b){return}s=i.outerHeight();u=i.outerWidth();c.scrollTop(0);c.scrollLeft(0);while(!i.is(".jspPane")){a+=i.position().top;h+=i.position().left;i=i.offsetParent();if(/^body|html$/i.test(i[0].nodeName)){return}}p=mt();v=p+l;if(a<p||n){g=a-o.verticalGutter}else{if(a+s>v){g=a-l+s+o.verticalGutter}}if(g){ht(g,r)}d=vt();m=d+f;if(h<d||n){y=h-o.horizontalGutter}else{if(h+u>m){y=h-f+u+o.horizontalGutter}}if(y){pt(y,r)}}function vt(){return-a.position().left}function mt(){return-a.position().top}function gt(){var e=p-l;return e>20&&e-mt()<10}function yt(){var e=h-f;return e>20&&e-vt()<10}function bt(){c.unbind(V).bind(V,function(e,t,n,r){var i=x,a=w;u.scrollBy(n*o.mouseWheelSpeed,-r*o.mouseWheelSpeed,false);return s.allowScrollEventBubble?i==x&&a==w:false})}function wt(){c.unbind(V)}function Et(){return false}function St(){a.find(":input,a").unbind("focus.jsp").bind("focus.jsp",function(e){dt(e.target,false)})}function xt(){a.find(":input,a").unbind("focus.jsp")}function Tt(){function s(){var e=x,r=w;switch(t){case 40:u.scrollByY(o.keyboardSpeed,false);break;case 38:u.scrollByY(-o.keyboardSpeed,false);break;case 34:case 32:u.scrollByY(l*o.scrollPagePercent,false);break;case 33:u.scrollByY(-l*o.scrollPagePercent,false);break;case 39:u.scrollByX(o.keyboardSpeed,false);break;case 37:u.scrollByX(-o.keyboardSpeed,false);break}n=e!=x||r!=w;return n}var t,n,r=[];g&&r.push(M[0]);m&&r.push(T[0]);a.focus(function(){i.focus()});i.attr("tabindex",0).unbind("keydown.jsp keypress.jsp").bind("keydown.jsp",function(i){if(i.target!==this&&!(r.length&&e(i.target).closest(r).length)){return}var o=x,u=w;switch(i.keyCode){case 40:case 38:case 34:case 32:case 33:case 39:case 37:t=i.keyCode;s();break;case 35:ht(p-l);t=null;break;case 36:ht(0);t=null;break}n=i.keyCode==t&&o!=x||u!=w;return!n}).bind("keypress.jsp",function(e){if(e.keyCode==t){s()}return!n});if(o.hideFocus){i.css("outline","none");if("hideFocus"in c[0]){i.attr("hideFocus",true)}}else{i.css("outline","");if("hideFocus"in c[0]){i.attr("hideFocus",false)}}}function Nt(){i.attr("tabindex","-1").removeAttr("tabindex").unbind("keydown.jsp keypress.jsp")}function Ct(){if(location.hash&&location.hash.length>1){var t,n,r=escape(location.hash.substr(1));try{t=e("#"+r+', a[name="'+r+'"]')}catch(i){return}if(t.length&&a.find(r)){if(c.scrollTop()===0){n=setInterval(function(){if(c.scrollTop()>0){dt(t,true);e(document).scrollTop(c.position().top);clearInterval(n)}},50)}else{dt(t,true);e(document).scrollTop(c.position().top)}}}}function kt(){if(e(document.body).data("jspHijack")){return}e(document.body).data("jspHijack",true);e(document.body).delegate("a[href*=#]","click",function(n){var r=this.href.substr(0,this.href.indexOf("#")),i=location.href,s,o,u,a,f,l;if(location.href.indexOf("#")!==-1){i=location.href.substr(0,location.href.indexOf("#"))}if(r!==i){return}s=escape(this.href.substr(this.href.indexOf("#")+1));o;try{o=e("#"+s+', a[name="'+s+'"]')}catch(c){return}if(!o.length){return}u=o.closest(".jspScrollable");a=u.data("jsp");a.scrollToElement(o,true);if(u[0].scrollIntoView){f=e(t).scrollTop();l=o.offset().top;if(l<f||l>f+e(t).height()){u[0].scrollIntoView()}}n.preventDefault()})}function Lt(){var e,t,n,r,i,s=false;c.unbind("touchstart.jsp touchmove.jsp touchend.jsp click.jsp-touchclick").bind("touchstart.jsp",function(o){var u=o.originalEvent.touches[0];e=vt();t=mt();n=u.pageX;r=u.pageY;i=false;s=true}).bind("touchmove.jsp",function(o){if(!s){return}var a=o.originalEvent.touches[0],f=x,l=w;u.scrollTo(e+n-a.pageX,t+r-a.pageY);i=i||Math.abs(n-a.pageX)>5||Math.abs(r-a.pageY)>5;return f==x&&l==w}).bind("touchend.jsp",function(e){s=false}).bind("click.jsp-touchclick",function(e){if(i){i=false;return false}})}function At(){var e=mt(),t=vt();i.removeClass("jspScrollable").unbind(".jsp");i.replaceWith(X.append(a.children()));X.scrollTop(e);X.scrollLeft(t);if(j){clearInterval(j)}}var o,u=this,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R=true,U=true,z=false,W=false,X=i.clone(false,false).empty(),V=e.fn.mwheelIntent?"mwheelIntent.jsp":"mousewheel.jsp";F=i.css("paddingTop")+" "+i.css("paddingRight")+" "+i.css("paddingBottom")+" "+i.css("paddingLeft");I=(parseInt(i.css("paddingLeft"),10)||0)+(parseInt(i.css("paddingRight"),10)||0);e.extend(u,{reinitialise:function(t){t=e.extend({},o,t);J(t)},scrollToElement:function(e,t,n){dt(e,t,n)},scrollTo:function(e,t,n){pt(e,n);ht(t,n)},scrollToX:function(e,t){pt(e,t)},scrollToY:function(e,t){ht(e,t)},scrollToPercentX:function(e,t,n){pt(e*(h-f),t,n)},scrollToPercentY:function(e,t){ht(e*(p-l),t)},scrollBy:function(e,t,n){u.scrollByX(e,n);u.scrollByY(t,n)},scrollByX:function(e,t){var n=vt()+Math[e<0?"floor":"ceil"](e),r=n/(h-f);at(r*S,t)},scrollByY:function(e,t){var n=mt()+Math[e<0?"floor":"ceil"](e),r=n/(p-l);ot(r*b,t)},positionDragX:function(e,t){at(e,t)},positionDragY:function(e,t){ot(e,t)},animate:function(e,t,n,r){var i={};i[t]=n;e.animate(i,{duration:o.animateDuration,easing:o.animateEase,queue:false,step:r})},getContentPositionX:function(){return vt()},getContentPositionY:function(){return mt()},getContentWidth:function(){return h},getContentHeight:function(){return p},getPercentScrolledX:function(){return vt()/(h-f)},getPercentScrolledY:function(){return mt()/(p-l)},getIsScrollableH:function(){return g},getIsScrollableV:function(){return m},getContentPane:function(){return a},scrollToBottom:function(e){ot(b,e)},hijackInternalLinks:e.noop,destroy:function(){At()}});J(s)}r=e.extend({},e.fn.jScrollPane.defaults,r);e.each(["mouseWheelSpeed","arrowButtonSpeed","trackClickSpeed","keyboardSpeed"],function(){r[this]=r[this]||r.speed});return this.each(function(){var t=e(this),n=t.data("jsp");if(n){n.reinitialise(r)}else{var s=e("script",t);s.filter('[type="text/javascript"]').remove();s.filter('[type=""]').remove();n=new i(t,r);t.data("jsp",n)}})};e.fn.jScrollPane.defaults={showArrows:false,maintainPosition:true,stickToBottom:false,stickToRight:false,allowScrollEventBubble:false,clickOnTrack:true,autoReinitialise:false,autoReinitialiseDelay:500,verticalDragMinHeight:0,verticalDragMaxHeight:99999,horizontalDragMinWidth:0,horizontalDragMaxWidth:99999,contentWidth:n,animateScroll:false,animateDuration:300,animateEase:"linear",hijackInternalLinks:false,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:0,arrowButtonSpeed:0,arrowRepeatFreq:50,arrowScrollOnHover:false,trackClickSpeed:0,trackClickRepeatFreq:70,verticalArrowPositions:"split",horizontalArrowPositions:"split",enableKeyboardNavigation:true,hideFocus:false,keyboardSpeed:0,initialDelay:300,speed:30,scrollPagePercent:.8,scrollCallback:false,allowedHorizontalScroll:true,allowedVerticalScroll:true}})(jQuery,this);
